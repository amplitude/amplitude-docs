# Amplitude Node.js SDK

## High-Level Overview

The Amplitude Node.js SDK is a server-side analytics tracking solution for Node.js applications, written in TypeScript. It enables developers to track user behavior, manage user properties, and analyze application usage patterns with reliable event tracking mechanisms including batching, retries, and customization options.

Key features:
- Event tracking and batching
- User identification and property management
- Revenue tracking
- User grouping
- Plugin architecture for extensibility
- EU data residency support
- TypeScript support with strong typing
- Ampli Wrapper for type-safe event tracking based on a tracking plan

Primary use cases:
- Server-side event tracking in Node.js applications
- Backend services tracking user interactions
- Consistent analytics across client and server environments
- Type-safe analytics implementation through tracking plans

## Product Relationships and Features

The Node.js SDK ecosystem consists of several interconnected components:

1. **Core SDK (@amplitude/analytics-node)**: The foundation package providing fundamental functionality for tracking events, managing user properties, and SDK configuration.

2. **Ampli Wrapper**: A generated, strongly-typed layer built on top of the core SDK that enforces tracking plans defined in Amplitude Data, providing type safety and validation.

3. **Plugin System**: An architecture allowing customization of event processing, transport, and storage through modular components.

4. **CLI Tool (ampli)**: A command-line interface for pulling tracking plans and generating Ampli Wrapper code.

The relationship between these components is hierarchical:
- Core SDK provides the foundation for sending events to Amplitude
- Ampli Wrapper uses the Core SDK but adds type safety and tracking plan enforcement
- Plugins extend the Core SDK's functionality
- CLI tool generates the Ampli Wrapper based on tracking plans

## Key Nomenclature and Definitions

- **Event**: A tracked user action in an application sent to Amplitude.
- **User Properties**: Attributes associated with users providing context for analysis.
- **Identify API**: Methods for setting, adding to, or removing user properties.
- **Group**: A collection of users with their own properties that can be analyzed together.
- **Tracking Plan**: A schema defining expected events and their properties.
- **Ampli Wrapper**: A generated SDK layer providing type-safe methods based on a tracking plan.
- **Plugin**: A modular component that can intercept/modify events or change SDK behavior.
- **Middleware**: (In the maintenance SDK) A function processing events before sending.
- **Flush**: The process of immediately sending all queued events.
- **Batch Processing**: Grouping multiple events to send in a single network request.

## Product Ecosystem Integration

The Node.js SDK integrates with Amplitude's broader analytics platform:

1. **Integration with Amplitude Analytics**: Sends data to Amplitude's analytics platform for analysis alongside client-side data.

2. **Complementary to Client SDKs**: Works with client-side SDKs (Web, iOS, Android) to provide a complete view of user behavior.

3. **Amplitude Data Integration**: Ampli Wrapper is generated from tracking plans defined in Amplitude Data, creating a closed loop between planning and implementation.

4. **Cross-Platform Consistency**: Server-side events can be correlated with client-side events for a unified user journey.

5. **Enterprise Features Support**: Supports enterprise features like EU data residency and custom event destinations.

## API Endpoints and Commands

### Core SDK Methods
- `init(apiKey, options)`: Initialize the SDK
- `track(event, options)`: Track an event
- `identify(identify, options)`: Set user properties
- `groupIdentify(groupType, groupName, identify, options)`: Set group properties
- `setGroup(groupType, groupName, options)`: Associate user with a group
- `revenue(revenue, options)`: Track revenue events
- `flush()`: Immediately send all queued events

### Ampli Wrapper Methods
- `ampli.load(options)`: Initialize the Ampli Wrapper
- `ampli.identify(userId, userProperties)`: Identify a user
- `ampli.track(event)`: Track a strongly-typed event
- `ampli.flush()`: Send all queued events

### CLI Commands
- `ampli pull`: Pull the latest tracking plan and generate the Ampli Wrapper
- `ampli status`: Check the status of the local implementation against the tracking plan

### Configuration Options
- `serverUrl`: API endpoint for sending events (default or EU)
- `flushQueueSize`: Maximum number of events to batch
- `flushIntervalMillis`: How often to automatically flush events
- `logLevel`: Control SDK log verbosity
- `minIdLength`: Minimum length for user and device IDs
- `transportProvider`: Custom HTTP client for sending events
- `storageProvider`: Custom storage for event queue

The SDK uses the Amplitude HTTP V2 API for sending events to Amplitude servers.

The documentation includes a migration guide for transitioning from the maintenance SDK (@amplitude/node) to the latest SDK (@amplitude/analytics-node), covering changes in initialization, configuration, API methods, and architecture.