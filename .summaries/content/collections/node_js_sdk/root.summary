# Amplitude Node.js SDK

The Amplitude Node.js SDK is a comprehensive analytics tracking solution designed for server-side Node.js applications. It provides robust event tracking, user identification, and analytics data collection capabilities with strong TypeScript support, flexible plugin architecture, and seamless integration with Amplitude's analytics platform.

## Product Architecture and Relationships

The Node.js SDK ecosystem consists of four interconnected components that work together to provide a complete analytics solution:

### Core SDK Components
- **@amplitude/analytics-node**: The current, actively maintained SDK built on Amplitude's HTTP V2 API featuring a modern plugin-based architecture
- **@amplitude/node**: The legacy SDK in maintenance mode that uses a middleware-based processing chain

### Code Generation Layer
- **Ampli Wrapper**: Available in two variants that generate strongly-typed tracking APIs from Amplitude Data tracking plans, supporting both current and legacy SDK runtimes

The architecture follows a clear data flow: tracking plan definition in Amplitude Data → Ampli CLI code generation → strongly-typed wrapper integration → underlying SDK implementation → event transmission to Amplitude's servers.

## Key Nomenclature and Definitions

### Core Tracking Concepts
- **Event Tracking**: Primary analytics data collection mechanism using `track()` (current SDK) or `logEvent()` (legacy SDK)
- **User Identification**: User property management through `identify()` method with Identify operations including set, setOnce, add, prepend, append, and remove
- **Group Analytics**: Organization-level tracking via `groupIdentify()` using groupType and groupName parameters
- **Revenue Tracking**: Monetization analytics through Revenue interface implementation with price, quantity, and productId properties

### Configuration Parameters
- **flushIntervalMillis/uploadIntervalInSec**: Controls batching frequency for event transmission
- **flushQueueSize/maxCachedEvents**: Defines buffer size threshold before forced transmission
- **serverZone**: Manages data residency requirements (EU/US regions)
- **useBatch**: Toggles batch API endpoint utilization for improved performance
- **minIdLength**: Sets user ID validation threshold requirements

### Architecture Components
- **Plugin System** (current SDK): Extensible architecture using EnrichmentPlugin and DestinationPlugin with PluginType enumeration
- **Middleware Chain** (legacy SDK): Event processing pipeline utilizing MiddlewarePayload for data transformation
- **Transport Layer**: Configurable HTTP transport system with custom transportProvider support

## Ecosystem Integration

The Node.js SDK integrates deeply with Amplitude's broader analytics platform through multiple integration points:

### Amplitude Data Integration
The Ampli Wrapper provides direct connectivity to Amplitude Data tracking plans, enabling schema-driven development workflows. This integration supports code generation via `ampli pull` and validation through `ampli status` commands.

### API Infrastructure
Both SDK variants utilize Amplitude's HTTP V2 API with batch processing capabilities, connecting to regional endpoints: api2.amplitude.com (US) and analytics.eu.amplitude.com (EU).

### Development Workflow
The ecosystem supports comprehensive development practices through TypeScript definitions, JSDoc annotations, Prettier linting integration, and migration tooling for transitioning between SDK versions.

## API Endpoints and CLI Commands

### Ampli CLI Operations
- `ampli pull`: Downloads and generates strongly-typed tracking code from defined tracking plans
- `ampli status`: Validates local implementation against tracking plan schemas for consistency

### Core SDK Methods
**Initialization and Configuration:**
- `init(apiKey, config)` (current SDK) or constructor-based initialization (legacy)
- `createInstance()` for multi-tenant application support

**Event Tracking:**
- `track(eventType, eventProperties, eventOptions)` or `logEvent(event)` for event collection
- `identify(userId, identifyEvent)` with Identify operations for user property management
- `groupIdentify(groupType, groupName, identifyEvent)` for group-level analytics

**Utility Methods:**
- `flush()` for immediate event transmission
- `setOptOut()` for privacy compliance
- Revenue interface implementation for monetization tracking

### Plugin and Middleware APIs
- `add(plugin)` for registering EnrichmentPlugin/DestinationPlugin components
- `addEventMiddleware(middleware)` for legacy middleware chain integration

The Node.js SDK provides a complete analytics solution with strong typing, flexible architecture, and comprehensive integration capabilities within Amplitude's analytics ecosystem.