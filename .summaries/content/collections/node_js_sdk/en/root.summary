# Amplitude Node.js SDK

## Overview

The Amplitude Node.js SDK is a server-side analytics tracking solution that enables developers to send event data to Amplitude from Node.js applications. The SDK is written in TypeScript and provides robust features for tracking user behavior, managing user properties, and analyzing application usage patterns. It offers reliable event tracking with built-in batching, retry mechanisms, and customization options.

Key features include:
- Event tracking and batching
- User identification and property management
- Revenue tracking
- User grouping
- Plugin architecture for extensibility
- EU data residency support
- TypeScript support with strong typing
- Ampli Wrapper for type-safe event tracking based on a tracking plan

Primary use cases:
- Server-side event tracking in Node.js applications
- Backend services that need to track user interactions
- Implementing consistent analytics across client and server environments
- Type-safe analytics implementation through tracking plans

## Product Relationships and Features

The Node.js SDK ecosystem consists of several interconnected components:

1. **Core SDK (@amplitude/analytics-node)**: The main SDK package that provides the fundamental functionality for tracking events, managing user properties, and configuring the SDK.

2. **Ampli Wrapper**: A generated, strongly-typed layer built on top of the core SDK that enforces a tracking plan defined in Amplitude Data. It provides type safety and validation for events and properties.

3. **Plugin System**: The SDK uses a plugin architecture that allows for customization of event processing, transport, and storage.

4. **CLI Tool (ampli)**: A command-line interface for pulling tracking plans and generating the Ampli Wrapper code.

The relationship between these components is hierarchical:
- The Core SDK provides the foundation for sending events to Amplitude
- The Ampli Wrapper uses the Core SDK but adds type safety and tracking plan enforcement
- Plugins extend the Core SDK's functionality
- The CLI tool generates the Ampli Wrapper based on tracking plans

## Key Nomenclature and Definitions

- **Event**: An action that a user performs in an application that is tracked and sent to Amplitude.
- **User Properties**: Attributes associated with a user that provide context for analysis.
- **Identify API**: Methods for setting, adding to, or removing user properties.
- **Group**: A collection of users that can have their own properties and be analyzed together.
- **Tracking Plan**: A schema that defines the expected events and their properties for an application.
- **Ampli Wrapper**: A generated SDK layer that provides type-safe methods based on a tracking plan.
- **Plugin**: A modular component that can intercept and modify events or change SDK behavior.
- **Middleware**: (In the maintenance SDK) A function that can process events before they are sent.
- **Flush**: The process of immediately sending all queued events to Amplitude.
- **Batch Processing**: Grouping multiple events together to send them in a single network request.

## Product Ecosystem Integration

The Node.js SDK is part of Amplitude's broader analytics platform:

1. **Integration with Amplitude Analytics**: The SDK sends data to Amplitude's analytics platform where it can be analyzed alongside client-side data.

2. **Complementary to Client SDKs**: The Node.js SDK is designed to work alongside client-side SDKs (Web, iOS, Android) to provide a complete view of user behavior across platforms.

3. **Amplitude Data Integration**: The Ampli Wrapper is generated based on tracking plans defined in Amplitude Data, creating a closed loop between planning and implementation.

4. **Cross-Platform Consistency**: Events tracked server-side can be correlated with client-side events to create a unified user journey.

5. **Enterprise Features Support**: The SDK supports enterprise features like EU data residency and custom event destinations.

## API Endpoints and Commands

### Core SDK Methods
- `init(apiKey, options)`: Initialize the SDK
- `track(event, options)`: Track an event
- `identify(identify, options)`: Set user properties
- `groupIdentify(groupType, groupName, identify, options)`: Set group properties
- `setGroup(groupType, groupName, options)`: Associate user with a group
- `revenue(revenue, options)`: Track revenue events
- `flush()`: Immediately send all queued events

### Ampli Wrapper Methods
- `ampli.load(options)`: Initialize the Ampli Wrapper
- `ampli.identify(userId, userProperties)`: Identify a user
- `ampli.track(event)`: Track a strongly-typed event
- `ampli.flush()`: Send all queued events

### CLI Commands
- `ampli pull`: Pull the latest tracking plan and generate the Ampli Wrapper
- `ampli status`: Check the status of the local implementation against the tracking plan

### Configuration Options
- `serverUrl`: API endpoint for sending events (default or EU)
- `flushQueueSize`: Maximum number of events to batch
- `flushIntervalMillis`: How often to automatically flush events
- `logLevel`: Control the verbosity of SDK logs
- `minIdLength`: Minimum length for user and device IDs
- `transportProvider`: Custom HTTP client for sending events
- `storageProvider`: Custom storage for event queue

The SDK uses the Amplitude HTTP V2 API for sending events to the Amplitude servers.

## Migration

The documentation includes a comprehensive migration guide for transitioning from the maintenance Node.js SDK (@amplitude/node) to the latest Node.js SDK (@amplitude/analytics-node), highlighting changes in initialization, configuration, API methods, and architecture. The latest SDK features a plugin architecture and built-in type definitions, replacing the middleware system in the older SDK.