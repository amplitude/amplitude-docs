# Amplitude Node.js SDK

## Overview

The Amplitude Node.js SDK is a server-side analytics tracking solution that enables developers to send event data to Amplitude from Node.js applications. The SDK provides robust capabilities for tracking user behavior, managing user properties, and analyzing application usage patterns. It features event batching, retry handling, and a plugin architecture for customizing event processing.

Key features include:
- Event tracking with rich metadata
- User identification and property management
- Revenue tracking
- User grouping
- Event batching and buffering
- EU data residency support
- TypeScript support with strong typing
- Plugin architecture for extensibility

Primary use cases include:
- Server-side event tracking in web applications
- Backend service analytics
- API usage monitoring
- User behavior analysis across services
- Cross-platform user journey tracking

## Product Relationships and Architecture

The Node.js SDK ecosystem consists of several interconnected components:

1. **Core SDK (@amplitude/analytics-node)**: The main implementation providing event tracking functionality, replacing the older maintenance SDK (@amplitude/node).

2. **Ampli Wrapper**: A generated, strongly-typed layer that sits on top of the core SDK, providing type safety based on a tracking plan defined in Amplitude Data.

3. **Plugin System**: Extensible architecture allowing custom event processing, replacing the older middleware approach.

The relationship flow is typically:
- Application code → Ampli Wrapper (optional) → Core SDK → Amplitude servers

The SDK can be used directly or through the Ampli Wrapper, which provides additional type safety and validation against a predefined tracking plan.

## Key Nomenclature and Definitions

- **Event**: A discrete user action or occurrence tracked in the system
- **Identify**: API for setting user properties without sending an event
- **Group**: A collection of users that can be tracked together
- **Tracking Plan**: A schema defining expected events and their properties
- **Ampli CLI**: Command-line tool for generating type-safe wrappers
- **Plugin**: Modular component that can intercept and modify events
- **Flush**: Process of sending batched events to Amplitude servers
- **User Properties**: Attributes associated with a specific user
- **Event Properties**: Attributes associated with a specific event
- **Batch Processing**: Grouping multiple events to send in a single request

## Product Ecosystem Integration

The Node.js SDK integrates with the broader Amplitude ecosystem in several ways:

1. **Amplitude Data Integration**: The Ampli Wrapper is generated based on tracking plans defined in Amplitude Data, ensuring consistency between documentation and implementation.

2. **Cross-Platform Tracking**: Works alongside other Amplitude SDKs (browser, mobile) to provide a complete view of user journeys across platforms.

3. **Analytics API**: Sends data to Amplitude's HTTP V2 API endpoint for processing and analysis.

4. **EU Data Residency**: Supports sending data to EU servers for compliance with regional data regulations.

The SDK is designed to work in conjunction with other Amplitude products, providing server-side tracking capabilities that complement client-side tracking solutions.

## API and Implementation Details

### Core SDK Installation

```bash
npm install @amplitude/analytics-node
# or
yarn add @amplitude/analytics-node
```

### Core SDK Initialization

```javascript
import { createInstance } from '@amplitude/analytics-node';

const amplitude = createInstance();
amplitude.init('API_KEY', {
  serverUrl: 'https://api.amplitude.com', // Default
  flushQueueSize: 200,                    // Default
  flushIntervalMillis: 10000,             // Default
  logLevel: 0                             // Default
});
```

### Key API Methods

- **track(event)**: Sends an event to Amplitude
- **identify(identify)**: Sets or updates user properties
- **setGroup(groupType, groupName)**: Associates a user with a group
- **revenue(revenue)**: Tracks revenue events
- **flush()**: Immediately sends all queued events

### Ampli Wrapper Installation

```bash
npm install @amplitude/analytics-node
npm install -g @amplitude/ampli
```

### Ampli Wrapper Generation

```bash
ampli pull
```

### Ampli Wrapper Initialization

```typescript
import { ampli } from './ampli';

ampli.load({
  client: {
    apiKey: 'API_KEY'
  }
});
```

### Plugin System

```javascript
const customPlugin = {
  name: 'customPlugin',
  type: 'before',
  execute: async (context) => {
    // Modify event
    return context;
  }
};

amplitude.add(customPlugin);
```

The Node.js SDK provides a comprehensive solution for server-side analytics tracking with strong TypeScript support, flexible configuration options, and seamless integration with the broader Amplitude ecosystem.