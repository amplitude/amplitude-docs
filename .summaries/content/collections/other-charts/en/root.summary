## Amplitude SQL and User Composition Analytics

Amplitude SQL is a specialized chart type that enables direct SQL querying against Amplitude event data stored in Snowflake databases. This feature is available as a Query add-on for Growth Enterprise plans and provides a simplified one-table schema design for custom analytics beyond standard Amplitude charts.

The core functionality centers around the `$events` table, which consolidates all event data into a single queryable structure. This table uses Snowflake's VARIANT data types to handle flexible event and user properties, with data refreshed every 30 minutes for near real-time analysis.

## Product Relationships and Features

**Amplitude SQL** serves as the primary custom querying interface, working alongside the **User Composition chart** to provide comprehensive user analytics. While Amplitude SQL focuses on event-driven queries with full SQL flexibility, User Composition analyzes users based on their properties rather than their events, creating complementary analytical approaches.

The User Composition chart operates through three key modules:
- **Composition By Module**: Defines which user property to analyze
- **Segment By Module**: Applies filtering criteria to user segments  
- **Measured As Module**: Determines how property values are calculated (Most Recent Value, All Values, or Cross Property Values)

## Key Nomenclature and Definitions

**Core Schema Elements:**
- `$events`: Shorthand reference for the main events table containing all Amplitude data
- `$amplitude_id`: Special field that automatically handles user identity mapping and merged user scenarios
- `$date`: Integrated field that works with Amplitude's datepicker for time-based filtering
- `merged_amplitude_id`: Handles user identity consolidation when users are merged

**Query Syntax:**
- `user_properties.property_name`: Prefix for accessing user-level attributes
- `event_properties.property_name`: Prefix for accessing event-specific attributes
- `event_time`: Calculated timestamp field derived from client_event_time or server_received_time
- VARIANT data types: Snowflake's flexible column format for storing JSON-like property data

**User Composition Terminology:**
- **Most Recent Value**: Uses the latest property value for each user
- **All Values**: Includes all historical values a user has had for a property
- **Cross Property Values**: Analyzes combinations across multiple user properties
- **Mutually Exclusive Buckets**: Users are categorized into distinct, non-overlapping segments

## Ecosystem Integration

Amplitude SQL integrates directly with Snowflake's data warehouse infrastructure, requiring the Query add-on and Growth Enterprise plan access. The system maintains a simplified schema that abstracts Amplitude's complex internal data structure into a single queryable table.

The `merged_amplitude_id` functionality demonstrates deep integration with Amplitude's user identity resolution system, automatically handling cases where user profiles have been consolidated. The `$date` field integration with Amplitude's datepicker ensures consistent time-based filtering across custom SQL queries and standard Amplitude charts.

**Limitations and Compatibility:**
- Portfolio Views are incompatible with Amplitude SQL charts
- User Composition displays top 13 property values maximum
- 30-minute data latency for SQL queries
- Time series visualization available for SQL results

The system supports both event-driven analysis (through Amplitude SQL) and user-centric analysis (through User Composition), providing flexibility for different analytical use cases while maintaining integration with Amplitude's broader analytics platform.