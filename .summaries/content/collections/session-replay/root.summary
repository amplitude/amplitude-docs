## Amplitude Session Replay

Amplitude Session Replay is a comprehensive user behavior analytics platform that captures and reconstructs user interactions across web, mobile, and React Native applications. The product provides visual insights through session recordings, heatmaps, and behavioral analytics to help teams understand user engagement patterns and optimize user experiences.

## Core Features and Capabilities

**Session Recording**: Captures DOM interactions, view tree changes, and user behaviors through diff-based replay construction. The system records user sessions with configurable sampling rates and stores data using IndexedDB for web applications.

**Heatmaps**: Provides three visualization types - click maps showing interaction hotspots, selector maps ranking interactive elements, and scroll maps displaying viewport scroll depth patterns. Available exclusively for web-based session replays on Growth/Enterprise plans.

**Privacy Controls**: Implements three masking levels (Conservative, Light, Medium) with CSS selector-based overrides, data attributes (data-amp-mask, data-amp-unmask), and .amp-block class exclusions to ensure PII protection and compliance.

**Multi-Platform Support**: Covers web browsers, Android, iOS/iPadOS, and React Native applications with platform-specific SDKs and plugins.

## Product Architecture and Integration Patterns

**Browser Implementation**: The core browser implementation uses `@amplitude/plugin-session-replay-browser` as a plugin for Browser SDK 2, with standalone options via `@amplitude/session-replay-browser` for non-Amplitude analytics environments.

**Mobile SDKs**: Android and iOS implementations follow three integration patterns:
- **Plugin Architecture**: For apps using modern Amplitude SDKs (SessionReplayPlugin for Android-Kotlin SDK, AmplitudeSwiftSessionReplayPlugin for iOS Swift SDK)
- **Middleware Pattern**: For apps using maintenance SDKs (SessionReplayMiddleware for Android SDK 2.40.1+, AmplitudeiOSSessionReplayMiddleware for iOS SDK 8.21.0+)
- **Standalone SDKs**: For third-party analytics integration requiring manual session/device ID management

**Third-Party Analytics Integration**: Supports Segment, Rudderstack, and Google Tag Manager through wrapper plugins and middleware that synchronize session IDs and inject session replay properties into analytics events.

## Key Nomenclature and Definitions

**Session Replay ID**: The `[Amplitude] Session Replay ID` event property that links analytics events to recorded sessions, captured via `getSessionReplayProperties()` method.

**Sample Rate**: Configuration parameter controlling the percentage of sessions recorded, supporting remote configuration and runtime adjustment.

**Masking Levels**: Privacy protection tiers (Conservative, Light, Medium) that automatically obscure sensitive content with CSS selector override capabilities.

**View Tree Capture**: Mobile-specific technology that captures native view hierarchies for Android and iOS applications, enabling replay reconstruction without DOM manipulation.

**Device/Session ID Synchronization**: Critical requirement for standalone implementations where session replay data must be correlated with third-party analytics through manual ID management using `setSessionId()` and `setDeviceId()` methods.

## Ecosystem Integration

**Analytics Correlation**: Session Replay integrates with Amplitude's broader analytics platform through automatic Session Start/Session End event generation and behavioral cohort creation from replay data.

**Data Residency**: Supports EU data residency through `serverZone` configuration and provides DSAR API metadata access and User Privacy API deletion capabilities for compliance.

**Performance Optimization**: Implements `requestIdleCallback` performance optimization, webworker compression, and configurable storage mechanisms to minimize application impact.

**Monitoring and Debugging**: Includes Session Replay Ingestion Monitor for tracking HTTP status codes (200, 429, 402), invalid session IDs, and implementation health monitoring.

## API Endpoints and Configuration

**Core Methods**:
- `sessionReplay.init()` - Initialize standalone SDK
- `amplitude.add(sessionReplayPlugin())` - Add plugin to Browser SDK
- `getSessionReplayProperties()` - Retrieve session replay metadata
- `start()`/`stop()` - Control recording state
- `setSessionId()`/`setDeviceId()` - Manual ID management

**Configuration Endpoints**:
- `configServerUrl`/`trackServerUrl` - Custom endpoint configuration
- `enableRemoteConfig` - Remote configuration enablement
- `serverZone` - Data residency control

**Integration Patterns**:
- GTM Web Template for Google Tag Manager
- `createSegmentActionsPlugin()` for Segment Actions destination
- Middleware registration via `addEventMiddleware()`/`removeEventMiddleware()`

The product requires specific SDK version minimums (Browser SDK Plugin 1.7.0+, Standalone SDK 1.14.0+) and integrates with package managers (npm, yarn, Maven Central, SPM, CocoaPods) and CDN distribution for flexible deployment options.