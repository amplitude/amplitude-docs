# Amplitude Session Replay

## Product Overview

Amplitude Session Replay is a visual analytics tool that captures and recreates user interactions with web and mobile applications in a video-like format. It allows product teams, developers, and analysts to visually understand user behavior by watching recordings of actual user sessions, providing insights into navigation patterns, friction points, and element interactions.

### Key Features

- **Session Recording**: Creates video-like replays by capturing DOM changes (web) or view tree changes (mobile)
- **Heatmaps**: Visual representations including click maps, selector maps, and scroll maps
- **Privacy Controls**: Multiple masking levels (Conservative, Light, Medium) with custom CSS selector overrides
- **Cross-Platform Support**: Available for web, iOS, Android, and React Native applications
- **Integration Options**: Works with Amplitude Analytics and third-party analytics providers
- **Implementation Monitoring**: Ingestion Monitor tool for tracking implementation status

## Product Relationships and Architecture

Session Replay offers multiple integration paths based on platform and existing analytics setup:

1. **Plugin/Middleware Approach** (for existing Amplitude users):
   - Browser SDK Plugin for web applications
   - iOS Plugin/Middleware for iOS apps
   - Android Plugin/Middleware for Android apps
   - React Native Plugin for React Native applications

2. **Standalone SDK Approach** (for third-party analytics users):
   - Browser, iOS, and Android Standalone SDKs

3. **Third-Party Integration Wrappers**:
   - Segment integration (Actions, Device-mode, Cloud-mode)
   - RudderStack integration
   - Google Tag Manager implementation

The data flow involves capturing user interactions, compressing and temporarily storing data, sending it to Amplitude servers with appropriate device and session IDs, and making recordings available for playback in the Amplitude interface.

## Key Nomenclature and Definitions

- **deviceId**: Unique identifier for a user's device that must match analytics events
- **sessionId**: Unique identifier for a user session that must match analytics events
- **sampleRate**: Configuration option (0-100) determining percentage of sessions to record
- **maskLevel**: Privacy setting controlling sensitive data handling (Conservative, Light, Medium)
- **getSessionReplayProperties()**: Method to retrieve Session Replay properties for third-party analytics
- **Page Fold**: Average point where users need to scroll to see more content
- **Selector Map**: Heatmap showing most interacted HTML elements with rankings
- **Click Map**: Heatmap showing most clicked areas by coordinates
- **Scroll Map**: Heatmap displaying aggregate scroll activity across sessions

## Product Ecosystem Integration

Session Replay is an add-on to Amplitude's core analytics platform, available to Growth and Enterprise plans. It integrates with:

- **Amplitude Analytics**: Direct integration through SDK plugins/middleware
- **Behavioral Cohorts**: Session Replay data can create behavioral cohorts for targeted analysis
- **Third-Party Analytics**: Through standalone SDKs and integration wrappers
- **Data Residency Options**: Supports EU data residency requirements

## API Endpoints and Implementation Details

### Web Implementation

```javascript
// Browser SDK Plugin
import * as amplitude from '@amplitude/analytics-browser';
import { sessionReplayPlugin } from '@amplitude/session-replay-browser';

amplitude.init('API_KEY', {
  plugins: [
    sessionReplayPlugin({
      sampleRate: 100,
      maskAllInputs: true
    })
  ]
});

// Standalone SDK
import { SessionReplay } from '@amplitude/session-replay-browser';

const sessionReplay = new SessionReplay({
  apiKey: 'API_KEY',
  deviceId: 'DEVICE_ID',
  sessionId: 'SESSION_ID',
  sampleRate: 100
});

// Get properties for third-party analytics
const sessionReplayProps = sessionReplay.getSessionReplayProperties();
```

### Mobile Implementation

```swift
// iOS Swift SDK Plugin
import AmplitudeSwift
import AmplitudeSessionReplay

let sessionReplayPlugin = SessionReplayPlugin(
    options: SessionReplayPlugin.Options(
        sampleRate: 100,
        maskingLevel: .light
    )
)

let amplitude = Amplitude(
    configuration: Configuration(
        apiKey: "API_KEY",
        plugins: [sessionReplayPlugin]
    )
)

// Android SDK Plugin
import com.amplitude.android.Amplitude
import com.amplitude.android.plugins.sessionreplay.SessionReplayPlugin

val sessionReplayPlugin = SessionReplayPlugin(
    options = SessionReplayPlugin.Options(
        sampleRate = 100,
        maskingLevel = MaskingLevel.LIGHT
    )
)

val amplitude = Amplitude(
    Configuration(
        apiKey = "API_KEY",
        context = applicationContext,
        plugins = listOf(sessionReplayPlugin)
    )
)
```

### Control Methods

```javascript
// Start/stop recording (Web)
sessionReplay.startRecording();
sessionReplay.stopRecording();

// Opt-out (Web)
sessionReplay.setOptOut(true);

// Android control methods
SessionReplay.getInstance().startRecording();
SessionReplay.getInstance().stopRecording();
SessionReplay.getInstance().setOptOut(true);

// iOS control methods
SessionReplay.shared.startRecording()
SessionReplay.shared.stopRecording()
SessionReplay.shared.setOptOut(true)
```

Session Replay has specific SDK version requirements and technical limitations including storage constraints and performance considerations that should be evaluated during implementation.