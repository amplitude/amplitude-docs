## Amplitude Session Replay

Amplitude Session Replay is a comprehensive user experience analytics solution that captures and reconstructs user interactions across web, mobile (iOS/Android), and React Native applications. The product enables organizations to record, analyze, and visualize user behavior through session recordings, heatmaps, and detailed interaction tracking while maintaining robust privacy controls and compliance with data protection regulations.

## Product Architecture and Integration Ecosystem

Session Replay operates through multiple implementation patterns designed to accommodate diverse technical architectures:

**Core SDK Implementations:**
- **Browser SDK Plugin** (`@amplitude/plugin-session-replay-browser`) - Primary integration for web applications using Amplitude Browser SDK 2
- **Standalone SDKs** - Independent implementations for organizations using third-party analytics providers (Segment, Rudderstack, Google Tag Manager)
- **Mobile Plugins** - Native iOS and Android plugins that integrate with existing Amplitude mobile SDKs
- **React Native Plugin** - Cross-platform solution for React Native applications

**Third-Party Analytics Integrations:**
The product provides specialized wrappers and plugins for major analytics platforms:
- **Segment Integration** - Multiple destination modes including Amplitude Actions, Classic Device-mode, and Cloud-mode implementations
- **Rudderstack Integration** - Cloud-mode wrapper with deviceId/sessionId mapping
- **Google Tag Manager** - GTM Web Template for client-side browser implementations

## Key Technical Components and Data Flow

**Session Capture Mechanism:**
Session Replay employs DOM capture and diff-based processing for web applications, while mobile implementations use view tree capture with diff-based replay construction. The system utilizes IndexedDB storage for browsers and implements WebWorker compression for optimal performance.

**Data Processing Pipeline:**
- Real-time DOM/view tree monitoring and change detection
- Diff-based payload construction to minimize data transmission
- CSS stylesheet inlining and Shadow DOM support for accurate replay reconstruction
- RequestIdleCallback optimization for performance-conscious recording

**Session Management:**
The system maintains session continuity through Session ID and Device ID synchronization across analytics providers. For standalone implementations, manual session management is required with explicit `setSessionId()` and `setDeviceId()` method calls.

## Privacy and Compliance Framework

**Multi-Level Data Masking:**
Session Replay implements three masking levels:
- **Conservative** - Maximum privacy protection with extensive PII masking
- **Light** - Minimal masking for basic privacy compliance
- **Medium** - Balanced approach between functionality and privacy

**Granular Privacy Controls:**
- CSS selector-based masking overrides using `.amp-block`, `amp-mask`, and `amp-unmask` attributes
- Component-level masking through `AmpMaskView` for React Native applications
- Remote configuration precedence for organizational privacy policy enforcement
- UGC Filter Rules (`ugcFilterRules`) using glob patterns for URL sanitization

**Regulatory Compliance:**
- GDPR compliance through Consent Management Platform (CMP) integration
- Cookie banner integration with first-party cookie categorization
- Data Subject Access Request (DSAR) API support for user data deletion
- EU data residency configuration through `serverZone` parameter

## Feature Set and Analytics Capabilities

**Heatmaps Functionality:**
Available for Growth/Enterprise plans, requiring Browser SDK Plugin 1.7.0+ or Standalone SDK 1.14.0+:
- **Click Maps** - Visual representation of user click interactions
- **Selector Maps** - Element-specific engagement tracking
- **Scroll Maps** - Viewport scroll depth and average page fold analysis

**Session Analysis Tools:**
- **Ingestion Monitor** - Real-time tracking of session replay ingestion status with HTTP status code monitoring (200, 429, 402)
- **Behavioral Cohorts** - User segmentation based on session replay interactions
- **Microscope Feature** - Detailed session inspection capabilities

## Configuration and Deployment

**Core Configuration Parameters:**
- `sampleRate` - Controls the percentage of sessions recorded (0.0 to 1.0)
- `privacyConfig`/`maskLevel` - Defines data masking intensity
- `enableRemoteConfig` - Enables server-side configuration management
- `optOut` - User consent and privacy control mechanism
- `serverZone` - Data residency configuration (US/EU)

**Installation Methods:**
- NPM/Yarn package management for JavaScript implementations
- Swift Package Manager and CocoaPods for iOS applications
- Maven Central for Android implementations
- CDN script tag integration for direct browser deployment

**API Methods and Endpoints:**
Key programmatic interfaces include:
- `amplitude.add(plugin)` / `amplitude.remove(plugin)` - Plugin lifecycle management
- `getSessionReplayProperties()` - Session metadata extraction for custom events
- `startRecording()` / `stopRecording()` - Manual recording control
- `flush()` - Force data transmission for standalone implementations
- `setSessionId()` / `setDeviceId()` - Manual session management for third-party integrations

The Session Replay product integrates seamlessly with Amplitude's broader analytics ecosystem while providing flexible deployment options for organizations with diverse technical requirements and privacy compliance needs.