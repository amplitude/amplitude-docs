# Amplitude Session Replay

## Product Overview

Amplitude Session Replay is a visual analytics tool that captures and recreates user interactions with web and mobile applications through video-like replays. It records DOM changes (web), view tree changes (mobile), and user interactions to provide product teams with visual insights into user behavior.

Key features include:
- Video-like session replays of user interactions
- Heatmaps (click maps, selector maps, scroll maps) for visualizing aggregate engagement
- Privacy controls with configurable masking levels for sensitive data
- Cross-platform support (Web, iOS, Android, React Native)
- Integration with third-party analytics providers
- Implementation monitoring tools

Primary use cases include debugging UX issues, understanding behavior patterns, identifying UI/UX improvements, validating product hypotheses, and troubleshooting conversion funnel drop-offs.

## Product Relationships and Architecture

Session Replay is an add-on to Amplitude's core analytics platform, available to Growth and Enterprise plans. The architecture consists of:

1. **SDK Components**:
   - Plugins/Middleware for existing Amplitude analytics SDK users
   - Standalone SDKs for third-party analytics users
   - Integration wrappers for platforms like Segment, RudderStack, and GTM

2. **Backend Services**:
   - Ingestion Pipeline for processing and storing replay data
   - Ingestion Monitor for tracking implementation health

3. **Frontend Visualization**:
   - Session Replay Player for viewing recordings
   - Heatmaps for aggregate behavior visualization
   - Microscope Feature connecting event data to corresponding replays

The product integrates with Amplitude's broader analytics ecosystem, connecting visual session data with event analytics and cohorts.

## Key Nomenclature and Definitions

- **Session Replay**: Video-like recreation of user interactions
- **Device ID**: Unique identifier linking replays to analytics data
- **Session ID**: Identifier correlating events within the same session
- **Sample Rate**: Percentage of sessions recorded (0.0-1.0)
- **Mask Level**: Privacy setting for handling sensitive data (Conservative, Light, Medium)
- **DOM Capture**: Recording of Document Object Model changes (web)
- **View Tree Capture**: Recording of UI component hierarchy changes (mobile)
- **Heatmaps**:
  - **Click Map**: Shows most clicked areas by coordinates
  - **Selector Map**: Highlights most interacted elements with rankings
  - **Scroll Map**: Displays aggregate scroll activity and average page fold
- **Page Fold**: Portion of webpage visible without scrolling
- **Remote Configuration**: Ability to update settings without code changes

## Product Ecosystem Integration

Session Replay integrates with the Amplitude ecosystem through:

1. **Core Analytics Integration**: Replays link to analytics events via Session Replay ID property
2. **Behavioral Cohorts**: Cohorts can be created based on session replay data
3. **Third-Party Analytics Integration**: Standalone SDKs link replay data with external analytics
4. **Data Privacy Framework**: Respects Amplitude's data privacy controls, including DSAR API
5. **EU Data Residency**: Supports keeping data in European data centers

## Implementation Methods and APIs

### Web Implementation

1. **Browser SDK Plugin** (for Amplitude Browser SDK 2.0+):
   ```javascript
   import * as amplitude from '@amplitude/analytics-browser';
   import { sessionReplayPlugin } from '@amplitude/session-replay-browser';
   
   amplitude.init('API_KEY', {
     plugins: [sessionReplayPlugin()]
   });
   ```

2. **Standalone SDK** (for third-party analytics):
   ```javascript
   import { SessionReplay } from '@amplitude/session-replay-browser-standalone';
   
   const sessionReplay = new SessionReplay({
     apiKey: 'API_KEY',
     deviceId: 'DEVICE_ID',
     sessionId: 'SESSION_ID'
   });
   
   const properties = sessionReplay.getSessionReplayProperties();
   ```

3. **Google Tag Manager**: Uses Amplitude Analytics Browser SDK template with Session Replay toggle

### iOS Implementation

Options include:
1. iOS Swift SDK Plugin
2. Legacy iOS SDK Middleware
3. Standalone SDK
4. Segment Integration

Key methods:
```swift
// Swift SDK Plugin
let sessionReplayPlugin = SessionReplayPlugin()
amplitude.add(plugin: sessionReplayPlugin)

// Control recording
sessionReplayPlugin.startRecording()
sessionReplayPlugin.stopRecording()
```

### Android Implementation

Options include:
1. Android SDK Plugin
2. Maintenance Android SDK Middleware
3. Standalone SDK

Key methods:
```kotlin
// Android SDK Plugin
val sessionReplayPlugin = SessionReplayPlugin()
amplitude.add(plugin: sessionReplayPlugin)

// Control recording
SessionReplay.startRecording()
SessionReplay.stopRecording()
```

### React Native Implementation

```javascript
import { sessionReplayPlugin } from '@amplitude/session-replay-react-native-plugin';

amplitude.init('API_KEY', {
  plugins: [sessionReplayPlugin()]
});

// Mask sensitive views
<AmpMaskView>
  <SensitiveComponent />
</AmpMaskView>
```

### Third-Party Integration APIs

1. **Segment**: Actions destination, Device-mode integration, Cloud-mode integration

2. **RudderStack**:
   ```javascript
   import { createSessionReplayRudderstackWrapper } from '@amplitude/session-replay-rudderstack';
   
   const rudderAnalytics = createSessionReplayRudderstackWrapper(window.rudderanalytics, {
     apiKey: 'AMPLITUDE_API_KEY'
   });
   ```

## Privacy and Configuration Controls

Session Replay offers:
- Three preset masking levels (Conservative, Light, Medium)
- Custom CSS selector overrides for specific elements
- Data attribute selectors for fine-grained control
- Remote configuration for updating settings without code changes
- User opt-out functionality
- EU data residency support

Configuration options include sample rate settings, storage limitations management, retention settings, and performance optimization. The Ingestion Monitor tool helps track implementation health with charts for successful requests and error types.