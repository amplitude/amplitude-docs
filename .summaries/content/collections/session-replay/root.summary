# Amplitude Session Replay

## Product Overview

Amplitude Session Replay is a visual analytics tool that captures and recreates user interactions with web and mobile applications in a video-like format. It records DOM changes (web) or view tree changes (mobile) to provide product teams with contextual insights beyond traditional analytics data. The tool enables teams to observe actual user behavior, identify usability issues, understand user journeys, and diagnose technical problems by showing exactly how users interact with applications.

Key features include:
- Video-like playback of user sessions
- Heatmaps for visualizing engagement patterns (click maps, selectors view, scrollmaps, average fold)
- Configurable privacy controls with data masking
- Cross-platform support (Web, iOS, Android, React Native)
- Integration with various analytics providers
- Sampling controls to manage data volume
- Implementation monitoring tools

## Product Relationships and Architecture

Session Replay functions as an addon to Amplitude's core analytics platform, available for Growth and Enterprise plans. It can be implemented through three main integration patterns:

1. **SDK Plugins/Middleware**: For applications already using Amplitude analytics
   - Browser, iOS, Android, and React Native SDK plugins

2. **Standalone SDKs**: For applications using third-party analytics providers
   - Web, iOS, and Android standalone SDKs

3. **Third-party Integration Wrappers**: For specific analytics platforms
   - Segment integration (via wrapper or middleware)
   - Google Tag Manager implementation
   - Rudderstack integration

The system captures user interactions and transmits this data to Amplitude's servers, where it's processed and made available for playback through the Amplitude dashboard. Proper synchronization of device IDs and session IDs between the analytics system and Session Replay is essential for correct association of replay data with analytics events.

## Key Nomenclature and Definitions

- **Session Replay**: Recording and playback of user interactions with an application
- **Heatmaps**: Visual representations of user engagement including:
  - **Click maps**: Shows where users click most frequently
  - **Selectors view**: Aggregates clicks on similar elements
  - **Scrollmaps**: Visualizes how far users scroll down a page
  - **Average fold**: The typical point where users stop scrolling

- **sampleRate**: Configuration parameter (0.0-1.0) determining percentage of sessions to record
- **maskLevel**: Privacy setting controlling data obscuration:
  - **Conservative**: Masks all text and images
  - **Light**: Masks only potentially sensitive inputs
  - **Medium**: Masks form fields and specific elements

- **deviceId**: Unique identifier for a user's device that must be synchronized between analytics and Session Replay
- **sessionId**: Identifier for a specific user session that must be synchronized for proper replay association
- **Ingestion Monitor**: Tool for tracking implementation status and debugging replay availability issues

## Product Ecosystem Integration

Session Replay integrates with Amplitude's broader analytics ecosystem in several ways:

1. **Core Analytics Integration**: Links replay data to analytics events through shared device and session IDs, enabling teams to move from quantitative metrics to qualitative session observations.

2. **Privacy and Compliance**: Leverages Amplitude's organization-level privacy settings and supports EU data residency requirements.

3. **Remote Configuration**: Can be controlled through Amplitude's remote configuration system for dynamic adjustment of sampling rates and privacy settings.

4. **Data Storage and Retention**: Uses IndexedDB for temporary client-side storage before transmission to Amplitude's servers, with retention policies aligned with the organization's Amplitude plan.

5. **DSAR Compliance**: Integrates with Amplitude's Data Subject Access Request API for privacy compliance.

## Implementation Details

### Web Implementation

```javascript
// Browser SDK Plugin
import * as amplitude from '@amplitude/analytics-browser';
import { sessionReplayPlugin } from '@amplitude/plugin-session-replay-browser';

amplitude.init('API_KEY', {
  plugins: [sessionReplayPlugin()]
});

// Standalone SDK
import { SessionReplay } from '@amplitude/session-replay-browser';

const sessionReplay = new SessionReplay({
  apiKey: 'API_KEY',
  deviceId: 'DEVICE_ID',
  sessionId: 'SESSION_ID'
});
```

### iOS Implementation

```swift
// Swift SDK Plugin
import AmplitudeSwift
import AmplitudeSessionReplay

let sessionReplayPlugin = SessionReplayPlugin()
let amplitude = Amplitude(
    configuration: Configuration(
        apiKey: "API_KEY",
        plugins: [sessionReplayPlugin]
    )
)

// Standalone SDK
import AmplitudeSessionReplay

let sessionReplay = SessionReplay(
    configuration: SessionReplayConfiguration(
        apiKey: "API_KEY",
        deviceId: "DEVICE_ID",
        sessionId: "SESSION_ID"
    )
)
```

### Android Implementation

```kotlin
// Kotlin SDK Plugin
import com.amplitude.android.Amplitude
import com.amplitude.android.plugins.sessionreplay.SessionReplayPlugin

val amplitude = Amplitude(
    Configuration(
        apiKey = "API_KEY",
        context = applicationContext,
        plugins = listOf(SessionReplayPlugin())
    )
)

// Standalone SDK
import com.amplitude.sessionreplay.SessionReplay

val sessionReplay = SessionReplay(
    SessionReplayConfiguration(
        apiKey = "API_KEY",
        applicationContext = applicationContext,
        deviceId = "DEVICE_ID",
        sessionId = "SESSION_ID"
    )
)
```

### React Native Implementation

```javascript
import { SessionReplayPlugin } from '@amplitude/react-native-session-replay';

const sessionReplayPlugin = new SessionReplayPlugin();
const client = createInstance();
client.add(sessionReplayPlugin);
```

## Technical Limitations

- Web implementation may have issues with Shadow DOM, certain CSS styling, and ad blockers
- Mobile implementations have storage limitations and may not support all UI frameworks
- WebView and MapView support varies by platform
- Some third-party integrations only support specific destination types
- Performance impact should be considered, especially with high sampling rates