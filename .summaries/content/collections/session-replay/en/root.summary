## Amplitude Session Replay

Amplitude Session Replay is a comprehensive user behavior analytics solution that captures and reconstructs user interactions across web, mobile (iOS/Android), and React Native applications. The product enables organizations to record, analyze, and visualize user sessions through DOM capture, view tree recording, and behavioral heatmaps while maintaining strict privacy compliance and data protection standards.

## Product Architecture and Integration Ecosystem

Session Replay operates through multiple SDK implementations designed for different platform and integration scenarios:

**Core SDK Types:**
- **Plugin Architecture**: Integrates with existing Amplitude Analytics SDKs (Browser SDK 2, iOS Swift SDK, Android-Kotlin SDK)
- **Middleware Integration**: Works with maintenance/legacy Amplitude SDKs (iOS SDK 8.21.0+, Android SDK 2.40.1+)
- **Standalone SDKs**: Independent implementation for third-party analytics providers
- **Third-Party Wrappers**: Specialized integrations for Segment, Rudderstack, and Google Tag Manager

**Platform Coverage:**
- **Web/Browser**: `@amplitude/plugin-session-replay-browser`, standalone SDK, GTM template
- **iOS/iPadOS**: AmplitudeSwiftSessionReplayPlugin, AmplitudeiOSSessionReplayMiddleware, standalone SDK
- **Android**: SessionReplayPlugin, SessionReplayMiddleware, standalone SDK
- **React Native**: SessionReplayPlugin, standalone SDK, Segment integration
- **Cross-Platform Integrations**: Segment Analytics, Rudderstack, Google Tag Manager

## Key Features and Capabilities

**Session Recording and Replay:**
- DOM capture with diff-based processing for web applications
- View tree capture and reconstruction for mobile platforms
- WebView tracking support across React Native implementations
- Real-time session reconstruction with CSS stylesheet inlining
- IndexedDB storage with webworker compression for performance optimization

**Heatmaps and Behavioral Analytics:**
- Click maps, selector maps, and scroll maps for user engagement visualization
- Viewport scroll depth analysis and average page fold metrics
- Behavioral cohort analysis with device identifier correlation
- URL pattern matching for targeted analysis
- Microscope feature for detailed interaction inspection

**Privacy and Compliance Framework:**
- Three-tier masking system: Conservative, Light, and Medium levels
- CSS selector-based masking overrides with `.amp-block` exclusion
- AmpMaskView components for React Native with `amp-mask`/`amp-unmask` properties
- UGC (User-Generated Content) filtering with glob pattern matching
- GDPR compliance tools with Consent Management Platform (CMP) integration
- DSAR API support for data subject access requests
- User Privacy API for data deletion workflows

## Technical Implementation and Configuration

**Core Configuration Parameters:**
- `sampleRate`: Controls session recording frequency (0.0-1.0)
- `maskLevel`: Defines privacy masking intensity (Conservative/Light/Medium)
- `serverZone`: Data residency control (US/EU)
- `enableRemoteConfig`: Allows server-side configuration management
- `optOut`: User consent and privacy controls
- `forceSessionTracking`: Override default session behavior

**Session Management:**
- Manual session ID synchronization via `setSessionId()` methods
- Device ID correlation through `setDeviceId()` configuration
- Session timestamp tracking for accurate replay sequencing
- `getSessionReplayProperties()` method returns `[Amplitude] Session Replay ID`
- Session Start/Session End event automatic generation

**API Endpoints and Methods:**
- `amplitude.add(plugin)` / `amplitude.remove(plugin)` for plugin management
- `addEventMiddleware()` / `removeEventMiddleware()` for middleware integration
- `sessionReplay.init()` for standalone SDK initialization
- `start()` / `stop()` methods for recording control
- `flush()` method for immediate data transmission

## Data Processing and Storage

**Technical Architecture:**
- Diff-based replay construction minimizes data payload size
- Shadow DOM support for complex web applications
- `requestIdleCallback` performance optimization
- Multiple Amplitude instance support with Device ID and API key matching
- Remote configuration precedence over local SDK settings

**Monitoring and Debugging:**
- Session Replay Ingestion Monitor with HTTP status tracking (200, 429, 402)
- Invalid session ID detection and reporting
- Users & Sessions tab for implementation troubleshooting
- CSS styling conflict resolution and processing error handling

## Privacy and Consent Management

**Compliance Features:**
- First-party cookie categorization for analytics consent
- Privacy policy disclosure templates and integration guidance
- Cookie banner CMP integration with consent state management
- Custom masking configuration through organizational settings
- Data retention policy configuration and enforcement

**Content Filtering:**
- UGC filter rules using glob patterns with wildcard matching
- URL sanitization for sensitive parameters and user identifiers
- PII anonymization through selector/replacement rule pairs
- Interaction config-based content filtering for heatmaps and session replay

The Session Replay ecosystem integrates seamlessly with Amplitude's broader analytics platform while providing flexible deployment options for organizations using third-party analytics providers, ensuring comprehensive user behavior insights across all digital touchpoints.