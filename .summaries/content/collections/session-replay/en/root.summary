## Amplitude Session Replay

Amplitude Session Replay is a comprehensive user behavior analytics solution that captures and reconstructs user interactions across web, mobile (iOS/Android), and React Native applications. The product provides visual insights through session recordings, heatmaps, and behavioral analytics to help teams understand user engagement patterns and optimize digital experiences.

## Core Features and Capabilities

**Session Recording & Playback**: Captures DOM interactions, user clicks, scrolls, and form inputs with diff-based replay construction that reconstructs user sessions with high fidelity while maintaining performance optimization.

**Heatmaps Analytics**: Provides click maps, selector maps, and scroll maps that visualize user engagement patterns, interactive element rankings, and viewport scroll depth analysis for web-based applications.

**Privacy & Compliance Controls**: Implements comprehensive data masking with three levels (Conservative, Light, Medium), CSS selector-based masking overrides, user consent management, and GDPR compliance features including opt-out mechanisms and data retention controls.

**Multi-Platform SDK Support**: Offers native SDKs and plugins for Browser SDK 2, Android (Kotlin/Java), iOS (Swift/Objective-C), React Native, with additional middleware support for legacy SDK versions.

## Product Architecture and Integration Patterns

**Primary Integration Modes**:
- **Plugin Architecture**: For applications already using Amplitude Analytics SDKs (`amplitude.add(plugin)`)
- **Middleware Integration**: For legacy/maintenance SDK versions (`addEventMiddleware()`)
- **Standalone SDKs**: For third-party analytics providers requiring manual session/device ID management
- **Third-Party Wrappers**: Specialized integrations for Segment, Rudderstack, and Google Tag Manager

**Data Flow and Session Management**: Session Replay generates unique Session Replay IDs that link recordings to analytics events through the `[Amplitude] Session Replay ID` event property. The system synchronizes device IDs and session IDs between analytics and replay data, with automatic session tracking or manual session management depending on integration type.

## Key Technical Components

**Browser Implementation**:
- `@amplitude/plugin-session-replay-browser` - Primary browser plugin
- `@amplitude/session-replay-browser` - Standalone browser SDK
- DOM capture with Shadow DOM support, CSS stylesheet inlining
- IndexedDB storage with configurable compression and WebWorker support

**Mobile SDKs**:
- **Android**: `SessionReplayPlugin`/`SessionReplayMiddleware` with view tree capture
- **iOS**: `AmplitudeSwiftSessionReplayPlugin`/`AmplitudeiOSSessionReplayMiddleware`
- **React Native**: `@amplitude/plugin-session-replay-react-native` with `AmpMaskView` masking

**Configuration APIs**:
- `sampleRate` - Controls recording percentage (0.0-1.0)
- `privacyConfig`/`maskLevel` - Data masking configuration
- `serverZone` - EU data residency support
- `enableRemoteConfig` - Remote configuration management
- `optOut` - User consent controls

## Privacy and Data Management

**Masking System**: Implements CSS selector-based masking with `.amp-block` class exclusion, `amp-mask`/`amp-unmask` properties for React Native, and conflict resolution between SDK and UI settings with remote configuration precedence.

**Consent Management**: Integrates with Consent Management Platforms (CMPs) for cookie banner compliance, provides privacy policy disclosure templates, and supports first-party cookie categorization for analytics compliance.

**Data Controls**: Includes DSAR API support for data subject access requests, User Privacy API for data deletion, configurable data retention, and UGC filter rules using glob patterns for URL sanitization.

## Monitoring and Analytics Integration

**Ingestion Monitoring**: Session Replay Ingestion Monitor tracks HTTP status codes (200, 429, 402) and invalid session IDs for debugging implementation issues and monitoring ingestion health.

**Third-Party Analytics Support**:
- **Segment**: Multiple integration modes including Amplitude Actions, Classic Device-mode, and Cloud-mode with `analytics_session_id` cookie synchronization
- **Rudderstack**: Cloud-mode integration with Anonymous ID/Session ID mapping
- **Google Tag Manager**: GTM Web Template with client-side browser implementation

**Event Integration**: Session replay data integrates with behavioral cohorts, device identifiers, and sample rate limitations while supporting anonymized session replay and viewport scroll depth analysis.

The product operates within Amplitude's broader analytics ecosystem, requiring Growth/Enterprise plans for advanced features like Heatmaps, and supporting both real-time session analysis and historical behavioral pattern analysis through the unified analytics platform.