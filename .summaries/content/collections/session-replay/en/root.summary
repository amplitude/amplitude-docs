## Amplitude Session Replay

Amplitude Session Replay is a comprehensive user behavior analytics feature that captures and reconstructs user interactions across web, mobile, and React Native applications. The product provides visual insights through session recordings, heatmaps, and behavioral analytics to help teams understand user engagement patterns and optimize digital experiences.

## Core Features and Capabilities

**Session Recording**: Captures DOM interactions, view tree changes, and user behaviors through diff-based replay construction. Sessions are stored with configurable retention periods and can be analyzed through Amplitude's analytics interface.

**Heatmaps**: Provides three visualization types - click maps showing interaction hotspots, selector maps ranking interactive elements, and scroll maps displaying viewport engagement depth. Available exclusively for web-based applications with Growth/Enterprise plans.

**Privacy Controls**: Implements three masking levels (Conservative, Light, Medium) with CSS selector-based overrides, data attributes (data-amp-mask, data-amp-unmask), and .amp-block class exclusions to ensure compliance with data privacy requirements.

**Multi-Platform Support**: Native SDKs and plugins for Browser, Android, iOS, React Native, with specialized integrations for Google Tag Manager, Segment, and Rudderstack analytics platforms.

## Product Architecture and Integration Patterns

**SDK Integration Models**:
- **Plugin Architecture**: For applications already using Amplitude Analytics SDKs (Browser SDK 2, Android-Kotlin SDK, iOS Swift SDK)
- **Middleware Pattern**: For legacy maintenance SDKs (Android SDK 2.40.1+, iOS SDK 8.21.0+) 
- **Standalone SDKs**: For third-party analytics providers requiring manual session/device ID management
- **Wrapper Integrations**: Pre-built connectors for Segment and Rudderstack with automatic session property injection

**Session Management**: All implementations require synchronized session IDs and device IDs between analytics providers and Session Replay. The system generates `[Amplitude] Session Replay ID` properties that must be attached to analytics events for correlation.

## Key Nomenclature and Technical Concepts

**Session Replay Properties**: Metadata objects returned by `getSessionReplayProperties()` containing session replay IDs that must be included in analytics track calls for proper correlation.

**Sample Rate Configuration**: Controls the percentage of sessions recorded (sampleRate parameter) to manage data volume and costs while maintaining statistical significance.

**Masking Levels**: 
- Conservative: Minimal masking for non-sensitive applications
- Light: Moderate masking for general use cases  
- Medium: Aggressive masking for sensitive data environments

**Remote Configuration**: Server-side control mechanism (`enableRemoteConfig`) allowing dynamic adjustment of recording parameters without code deployments.

**Data Residency**: ServerZone configuration supporting EU data residency requirements for GDPR compliance.

## Platform-Specific Implementation Details

**Browser Implementation**:
- Primary package: `@amplitude/plugin-session-replay-browser`
- DOM capture with shadow DOM support
- IndexedDB storage with webworker compression
- CSS stylesheet inlining and performance optimization via requestIdleCallback

**Android Implementation**:
- Plugin: `plugin-session-replay-android` for Android-Kotlin SDK
- Middleware: `middleware-session-replay-android` for maintenance SDK
- View tree capture with Jetpack Compose support (WebView limitations apply)
- Maven Central distribution

**iOS Implementation**:
- Plugin: `AmplitudeSwiftSessionReplayPlugin` for iOS Swift SDK
- Middleware: `AmplitudeiOSSessionReplayMiddleware` for legacy SDK
- Swift Package Manager and CocoaPods distribution
- View tree capture for iOS/iPadOS applications

**React Native Implementation**:
- Package: `@amplitude/plugin-session-replay-react-native`
- AmpMaskView component with amp-mask/amp-unmask properties
- WebView tracking capabilities
- start()/stop() recording control methods

## Third-Party Analytics Integration

**Segment Integration**:
- Actions destination: `@amplitude/segment-session-replay-plugin` with createSegmentActionsPlugin
- Device-mode: Direct amplitude-js SDK integration with sessionReplayPlugin
- Cloud-mode: Source middleware with analytics_session_id cookie synchronization

**Rudderstack Integration**:
- Wrapper package: `@amplitude/session-replay-browser`
- Method overrides for rudderAnalytics.track() and rudderAnalytics.page()
- Anonymous ID and Session ID mapping from Rudderstack context

## Monitoring and Debugging Tools

**Session Replay Ingestion Monitor**: Real-time dashboard tracking ingestion health with HTTP status code monitoring (200 success, 429 throttling, 402 quota exceeded) and invalid session ID detection for implementation troubleshooting.

**Privacy Configuration UI**: Organizational settings interface allowing CSS selector-based masking rules that take precedence over SDK configurations for centralized privacy management.

## API Methods and Configuration

**Core Methods**:
- `sessionReplay.init()` - Initialize standalone SDK
- `amplitude.add(plugin)` - Register plugin with Analytics SDK
- `getSessionReplayProperties()` - Retrieve session metadata for analytics correlation
- `setSessionId()`/`setDeviceId()` - Manual ID synchronization for standalone implementations
- `start()`/`stop()` - Recording control for React Native

**Configuration Parameters**:
- `sampleRate` - Session recording percentage (0.0-1.0)
- `privacyConfig`/`maskLevel` - Data masking configuration
- `serverZone` - Data residency control (US/EU)
- `optOut` - User consent management
- `enableRemoteConfig` - Server-side configuration enablement

The Session Replay ecosystem integrates deeply with Amplitude's broader analytics platform, supporting Behavioral Cohorts creation, DSAR API compliance for data deletion requests, and User Privacy API integration for comprehensive data governance.