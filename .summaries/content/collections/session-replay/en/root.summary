# Amplitude Session Replay

## Product Overview

Amplitude Session Replay is a visual analytics tool that captures and recreates user interactions with web and mobile applications, allowing product teams to watch video-like replays of actual user sessions. The product provides insights into user behavior by recording DOM changes (web), view tree changes (mobile), and user interactions to create comprehensive session recordings that can be analyzed alongside other Amplitude analytics data.

Key features include:
- Video-like session replays of user interactions
- Heatmaps (click maps, selector maps, scroll maps) for visualizing aggregate user engagement
- Privacy controls with configurable masking levels for sensitive data
- Cross-platform support (Web, iOS, Android, React Native)
- Integration capabilities with third-party analytics providers
- Implementation monitoring tools

Primary use cases include:
- Debugging user experience issues
- Understanding user behavior patterns
- Identifying UI/UX improvement opportunities
- Validating product hypotheses with visual evidence
- Troubleshooting conversion funnel drop-offs

## Product Relationships and Architecture

Session Replay functions as an add-on to Amplitude's core analytics platform, available to Growth and Enterprise plans. The product consists of several components that work together:

1. **SDK Components**:
   - **Plugins/Middleware**: For customers already using Amplitude analytics SDKs
   - **Standalone SDKs**: For customers using third-party analytics providers
   - **Integration Wrappers**: For specific third-party platforms (Segment, RudderStack, GTM)

2. **Backend Services**:
   - **Ingestion Pipeline**: Processes and stores session replay data
   - **Ingestion Monitor**: Tracks implementation health and debugging

3. **Frontend Visualization**:
   - **Session Replay Player**: For viewing recorded sessions
   - **Heatmaps**: For aggregate visualization of user behavior
   - **Microscope Feature**: Connects event data to corresponding session replays

The product is designed to work seamlessly with Amplitude's broader analytics ecosystem, connecting session replay data with event analytics, cohorts, and other Amplitude features.

## Key Nomenclature and Definitions

- **Session Replay**: Video-like recreation of user interactions with an application
- **Device ID**: Unique identifier for a user's device, used to link session replays to analytics data
- **Session ID**: Identifier for a specific user session, used to correlate events within the same session
- **Sample Rate**: Percentage of sessions that are recorded (0.0-1.0), used to control data volume
- **Mask Level**: Privacy setting that determines how sensitive data is handled (Conservative, Light, Medium)
- **DOM Capture**: Process of recording Document Object Model changes for web applications
- **View Tree Capture**: Process of recording UI component hierarchy changes for mobile applications
- **Heatmaps**:
  - **Click Map**: Shows most clicked areas by coordinates
  - **Selector Map**: Highlights most interacted elements with rankings
  - **Scroll Map**: Displays aggregate scroll activity and average page fold
- **Page Fold**: The portion of a webpage visible without scrolling
- **Remote Configuration**: Ability to update Session Replay settings without code changes

## Product Ecosystem Integration

Session Replay integrates with the broader Amplitude ecosystem in several ways:

1. **Core Analytics Integration**: Session replays are linked to analytics events via the Session Replay ID property, allowing users to jump from event analysis to visual session context.

2. **Behavioral Cohorts**: Users can create cohorts based on session replay data and use them throughout Amplitude.

3. **Third-Party Analytics Integration**: For non-Amplitude analytics users, the standalone SDKs provide methods to link session replay data with external analytics systems.

4. **Data Privacy Framework**: Session Replay respects Amplitude's broader data privacy controls, including DSAR API integration for user data deletion requests.

5. **EU Data Residency**: Supports EU data residency requirements for customers needing to keep data in European data centers.

## Implementation Methods and APIs

### Web Implementation

1. **Browser SDK Plugin** (for Amplitude Browser SDK 2.0+):
   ```javascript
   import * as amplitude from '@amplitude/analytics-browser';
   import { sessionReplayPlugin } from '@amplitude/session-replay-browser';
   
   amplitude.init('API_KEY', {
     plugins: [sessionReplayPlugin()]
   });
   ```

2. **Standalone SDK** (for third-party analytics):
   ```javascript
   import { SessionReplay } from '@amplitude/session-replay-browser-standalone';
   
   const sessionReplay = new SessionReplay({
     apiKey: 'API_KEY',
     deviceId: 'DEVICE_ID',
     sessionId: 'SESSION_ID'
   });
   
   // Get properties to link with third-party analytics
   const properties = sessionReplay.getSessionReplayProperties();
   ```

3. **Google Tag Manager**:
   - Uses Amplitude Analytics Browser SDK template
   - Requires enabling Session Replay toggle in template settings

### iOS Implementation

Multiple implementation options:
1. iOS Swift SDK Plugin
2. Legacy iOS SDK Middleware
3. Standalone SDK
4. Segment Integration

Key methods:
```swift
// Swift SDK Plugin
let sessionReplayPlugin = SessionReplayPlugin()
amplitude.add(plugin: sessionReplayPlugin)

// Control recording
sessionReplayPlugin.startRecording()
sessionReplayPlugin.stopRecording()
```

### Android Implementation

Multiple implementation options:
1. Android SDK Plugin
2. Maintenance Android SDK Middleware
3. Standalone SDK

Key methods:
```kotlin
// Android SDK Plugin
val sessionReplayPlugin = SessionReplayPlugin()
amplitude.add(plugin: sessionReplayPlugin)

// Control recording
SessionReplay.startRecording()
SessionReplay.stopRecording()
```

### React Native Implementation

```javascript
import { sessionReplayPlugin } from '@amplitude/session-replay-react-native-plugin';

amplitude.init('API_KEY', {
  plugins: [sessionReplayPlugin()]
});

// Mask sensitive views
<AmpMaskView>
  <SensitiveComponent />
</AmpMaskView>
```

### Third-Party Integration APIs

1. **Segment**:
   - Actions destination
   - Device-mode integration
   - Cloud-mode integration

2. **RudderStack**:
   ```javascript
   import { createSessionReplayRudderstackWrapper } from '@amplitude/session-replay-rudderstack';
   
   const rudderAnalytics = createSessionReplayRudderstackWrapper(window.rudderanalytics, {
     apiKey: 'AMPLITUDE_API_KEY'
   });
   ```

## Privacy and Configuration Controls

Session Replay offers extensive privacy controls:
- Three preset masking levels (Conservative, Light, Medium)
- Custom CSS selector overrides for masking/unmasking specific elements
- Data attribute selectors for fine-grained control
- Remote configuration for updating settings without code changes
- User opt-out functionality
- EU data residency support

Configuration options include:
- Sample rate (0.0-1.0) to control data volume
- Storage limitations management
- Session replay retention settings
- Performance optimization settings

The Ingestion Monitor tool helps track implementation health, displaying charts for successful requests and various error types to assist with debugging unavailable session replays.