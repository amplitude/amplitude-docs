# Amplitude Session Replay

## Product Overview

Amplitude Session Replay is a visual analytics tool that captures and recreates user interactions with web and mobile applications in a video-like format. It allows product teams, developers, and analysts to visually understand user behavior by watching recordings of actual user sessions. The product provides insights into how users navigate through applications, where they encounter friction, and how they interact with different elements.

### Key Features

1. **Session Recording**: Captures DOM changes (web) or view tree changes (mobile) to create video-like replays of user sessions.
2. **Heatmaps**: Visual representations of user engagement through:
   - Click maps: Shows most clicked areas by coordinates
   - Selector maps: Highlights most interacted elements with rankings
   - Scroll maps: Displays aggregate scroll activity and average page fold

3. **Privacy Controls**: Multiple masking levels (Conservative, Light, Medium) and custom CSS selector overrides to protect sensitive user data.
4. **Cross-Platform Support**: Available for web (Browser SDK), iOS, Android, and React Native applications.
5. **Integration Options**: Works with Amplitude Analytics and third-party analytics providers through standalone SDKs.
6. **Implementation Monitoring**: Ingestion Monitor tool tracks implementation status and helps debug issues.

### Use Cases

- Debugging user-reported issues by watching session replays
- Understanding user friction points and drop-offs
- Validating UI/UX design effectiveness
- Analyzing user behavior patterns
- Identifying optimization opportunities

## Product Relationships and Architecture

### SDK Integration Options

Session Replay offers multiple integration paths depending on the platform and existing analytics setup:

1. **Plugin/Middleware Approach** (for existing Amplitude users):
   - Browser SDK Plugin: For web applications using Amplitude Browser SDK 2
   - iOS Plugin/Middleware: For iOS apps using Amplitude iOS Swift SDK or maintenance iOS SDK
   - Android Plugin/Middleware: For Android apps using Amplitude Android-Kotlin SDK or maintenance Android SDK
   - React Native Plugin: For React Native applications using Amplitude React Native SDK

2. **Standalone SDK Approach** (for third-party analytics users):
   - Browser Standalone SDK: For web applications using non-Amplitude analytics
   - iOS Standalone SDK: For iOS apps using third-party analytics
   - Android Standalone SDK: For Android apps using third-party analytics

3. **Third-Party Integration Wrappers**:
   - Segment integration (Actions, Device-mode, Cloud-mode)
   - RudderStack integration
   - Google Tag Manager implementation

### Data Flow

Session Replay captures user interactions and sends them to Amplitude's servers, where they are processed and made available for playback. The system requires proper session and device ID mapping to link session recordings with analytics events:

1. Session data is captured through DOM/view tree monitoring
2. Data is compressed and stored temporarily in IndexedDB (web) or local storage (mobile)
3. Data is sent to Amplitude servers with appropriate device and session IDs
4. Recordings are processed and made available for playback in the Amplitude interface

## Key Nomenclature and Definitions

- **deviceId**: Unique identifier for a user's device, must match the deviceId used in analytics events
- **sessionId**: Unique identifier for a user session, must match the sessionId used in analytics events
- **sampleRate**: Configuration option (0-100) determining what percentage of sessions to record
- **maskLevel**: Privacy setting that controls how sensitive data is handled (Conservative, Light, Medium)
- **getSessionReplayProperties()**: Method to retrieve Session Replay properties for integration with third-party analytics
- **Page Fold**: In scroll maps, represents the average point where users need to scroll to see more content
- **Selector Map**: Heatmap showing most interacted HTML elements with ranking information
- **Click Map**: Heatmap showing most clicked areas by coordinates
- **Scroll Map**: Heatmap displaying aggregate scroll activity across sessions

## Product Ecosystem Integration

Session Replay is an add-on to Amplitude's core analytics platform, available to Growth and Enterprise plans. It integrates with:

1. **Amplitude Analytics**: Direct integration through SDK plugins/middleware
2. **Behavioral Cohorts**: Session Replay data can be used to create behavioral cohorts for targeted analysis
3. **Third-Party Analytics**: Through standalone SDKs and integration wrappers
4. **Data Residency Options**: Supports EU data residency requirements

## API Endpoints and Implementation Details

### Web Implementation

```javascript
// Browser SDK Plugin
import * as amplitude from '@amplitude/analytics-browser';
import { sessionReplayPlugin } from '@amplitude/session-replay-browser';

amplitude.init('API_KEY', {
  plugins: [
    sessionReplayPlugin({
      sampleRate: 100,
      maskAllInputs: true
    })
  ]
});

// Standalone SDK
import { SessionReplay } from '@amplitude/session-replay-browser';

const sessionReplay = new SessionReplay({
  apiKey: 'API_KEY',
  deviceId: 'DEVICE_ID',
  sessionId: 'SESSION_ID',
  sampleRate: 100
});

// Get properties for third-party analytics
const sessionReplayProps = sessionReplay.getSessionReplayProperties();
```

### Mobile Implementation

```swift
// iOS Swift SDK Plugin
import AmplitudeSwift
import AmplitudeSessionReplay

let sessionReplayPlugin = SessionReplayPlugin(
    options: SessionReplayPlugin.Options(
        sampleRate: 100,
        maskingLevel: .light
    )
)

let amplitude = Amplitude(
    configuration: Configuration(
        apiKey: "API_KEY",
        plugins: [sessionReplayPlugin]
    )
)

// Android SDK Plugin
import com.amplitude.android.Amplitude
import com.amplitude.android.plugins.sessionreplay.SessionReplayPlugin

val sessionReplayPlugin = SessionReplayPlugin(
    options = SessionReplayPlugin.Options(
        sampleRate = 100,
        maskingLevel = MaskingLevel.LIGHT
    )
)

val amplitude = Amplitude(
    Configuration(
        apiKey = "API_KEY",
        context = applicationContext,
        plugins = listOf(sessionReplayPlugin)
    )
)
```

### Control Methods

```javascript
// Start/stop recording (Web)
sessionReplay.startRecording();
sessionReplay.stopRecording();

// Opt-out (Web)
sessionReplay.setOptOut(true);

// Android control methods
SessionReplay.getInstance().startRecording();
SessionReplay.getInstance().stopRecording();
SessionReplay.getInstance().setOptOut(true);

// iOS control methods
SessionReplay.shared.startRecording()
SessionReplay.shared.stopRecording()
SessionReplay.shared.setOptOut(true)
```

Session Replay requires specific SDK versions and has certain technical limitations, including storage constraints and performance considerations that should be evaluated during implementation.