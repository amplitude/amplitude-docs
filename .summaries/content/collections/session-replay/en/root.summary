# Amplitude Session Replay

## Product Overview

Amplitude Session Replay is a visual analytics tool that captures and recreates user interactions with web and mobile applications in a video-like format. It allows product teams, developers, and analysts to visually observe how users navigate through applications, interact with elements, and encounter issues. Session Replay complements Amplitude's core analytics by providing qualitative context to quantitative data.

### Key Features

1. **Session Recording and Playback**: Captures DOM changes (web) or view tree changes (mobile) to create video-like replays of user sessions.

2. **Heatmaps**: Provides visual representations of user engagement through:
   - Click maps: Shows most clicked areas by coordinates
   - Selector maps: Highlights most interacted elements with rankings
   - Scroll maps: Displays aggregate scroll activity and average page fold

3. **Privacy Controls**: Offers multiple masking levels (Conservative, Light, Medium) and custom CSS selector overrides to protect sensitive user data.

4. **Cross-Platform Support**: Available for web (Browser SDK), iOS, Android, and React Native applications.

5. **Integration Options**: Works with Amplitude Analytics and third-party analytics providers through standalone SDKs and integrations with platforms like Segment, Rudderstack, and Google Tag Manager.

6. **Implementation Monitoring**: Provides an Ingestion Monitor tool to track implementation status and troubleshoot issues with session replay availability.

## Product Relationships and Architecture

Session Replay functions as an add-on to Amplitude's core analytics platform, available to Growth and Enterprise plans. It can be implemented in several ways:

1. **Plugin/Middleware Architecture**: For applications already using Amplitude Analytics:
   - Browser SDK Plugin
   - iOS SDK Plugin/Middleware
   - Android SDK Plugin/Middleware
   - React Native SDK Plugin

2. **Standalone SDKs**: For applications using third-party analytics providers:
   - Browser Standalone SDK
   - iOS Standalone SDK
   - Android Standalone SDK

3. **Integration Wrappers**: For applications using specific analytics platforms:
   - Segment integration (Actions destination, Classic device-mode, Classic cloud-mode)
   - Rudderstack integration
   - Google Tag Manager implementation

The Session Replay system captures user interactions and sends this data to Amplitude's servers, where it's processed and made available for playback through the Amplitude interface. The system uses the device ID and session ID to link replay data with analytics events.

## Key Nomenclature and Definitions

- **Session ID**: Unique identifier for a user session that links analytics events to session replay data.
- **Device ID**: Unique identifier for a user's device that helps associate sessions with specific users.
- **Sample Rate**: Configuration parameter (0.0-1.0) that determines what percentage of sessions are recorded.
- **Masking Levels**:
  - **Conservative**: Masks all text content and images
  - **Light**: Masks only input fields and images
  - **Medium**: Masks only input fields
- **CSS Selector Overrides**: Custom rules to mask, unmask, or exclude specific elements from recording.
- **View Tree/DOM Capture**: The technical process of recording UI changes for later playback.
- **Page Fold**: The portion of a webpage visible without scrolling, visualized in scroll maps.
- **Heatmaps**: Visual representations of aggregate user behavior (clicks, scrolls, interactions).

## Product Ecosystem Integration

Session Replay integrates with the broader Amplitude ecosystem in several ways:

1. **Analytics Integration**: Session replay data is linked to analytics events through session IDs, allowing users to jump from analytics insights directly to relevant session replays.

2. **Behavioral Cohorts**: Users can create cohorts based on specific behaviors and then watch session replays from those cohorts.

3. **Remote Configuration**: Session Replay settings can be managed remotely through Amplitude's organization settings, allowing for centralized privacy control.

4. **Data Residency**: Supports EU data residency requirements for organizations that need to keep data in European data centers.

5. **Microscope Feature**: Allows direct navigation from analytics events to associated session replays for deeper context.

## API Endpoints and Implementation Details

### Browser SDK Plugin Implementation
```javascript
import * as amplitude from '@amplitude/analytics-browser';
import { sessionReplayPlugin } from '@amplitude/plugin-session-replay-browser';

amplitude.init('API_KEY', {
  plugins: [sessionReplayPlugin()]
});
```

### iOS Swift SDK Implementation
```swift
import AmplitudeSwift
import AmplitudeSessionReplay

let sessionReplayPlugin = SessionReplayPlugin()
let amplitude = Amplitude(
    configuration: Configuration(
        apiKey: "API_KEY",
        plugins: [sessionReplayPlugin]
    )
)
```

### Android SDK Implementation
```kotlin
val sessionReplayPlugin = SessionReplayPlugin()
val amplitude = Amplitude(
    Configuration(
        apiKey = "API_KEY",
        context = applicationContext,
        plugins = listOf(sessionReplayPlugin)
    )
)
```

### Standalone SDK Implementation (Browser)
```javascript
import { SessionReplay } from '@amplitude/session-replay-browser';

const sessionReplay = new SessionReplay({
  apiKey: 'API_KEY',
  deviceId: 'DEVICE_ID',
  sessionId: 'SESSION_ID'
});
```

### Configuration Options
- `sampleRate`: Controls percentage of sessions recorded (0.0-1.0)
- `maskAllText`: Boolean to enable/disable text masking
- `maskAllInputs`: Boolean to enable/disable input field masking
- `maskAllImages`: Boolean to enable/disable image masking
- `blockClass`: CSS classes to exclude from recording
- `blockSelector`: CSS selectors to exclude from recording
- `maskTextClass`: CSS classes whose text should be masked
- `maskTextSelector`: CSS selectors whose text should be masked
- `euDataResidency`: Boolean to enable EU data storage

### Runtime Control Methods
- `startRecording()`: Begin session recording
- `stopRecording()`: Pause session recording
- `getSessionReplayProperties()`: Get properties to link analytics events with session replay data
- `flush()`: Force send recorded data to Amplitude servers