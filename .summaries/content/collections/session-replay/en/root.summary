# Amplitude Session Replay

## Product Overview

Amplitude Session Replay is a visual analytics tool that captures and recreates user interactions with web and mobile applications, allowing developers and product teams to visualize exactly how users navigate through their digital experiences. The product records DOM changes, view tree modifications, and user interactions to create video-like replays of user sessions, providing context beyond traditional analytics data.

Key features include:
- Session recording across web, iOS, Android, and React Native platforms
- Heatmaps for visualizing user engagement patterns
- Privacy controls with configurable data masking levels
- Integration options with various analytics providers
- Implementation monitoring tools
- Sampling capabilities to manage data volume

Primary use cases include debugging user experience issues, understanding user behavior patterns, validating design changes, and identifying conversion obstacles.

## Product Architecture and Relationships

Amplitude Session Replay is available as an addon for Growth and Enterprise plans and can be implemented through several integration methods:

1. **SDK Plugins/Middleware**:
   - Browser SDK Plugin for web applications
   - iOS SDK Plugin/Middleware for iOS applications
   - Android SDK Plugin/Middleware for Android applications
   - React Native SDK Plugin for cross-platform mobile applications

2. **Standalone SDKs**:
   - Web Standalone SDK
   - iOS Standalone SDK
   - Android Standalone SDK

3. **Third-party Integration Wrappers**:
   - Google Tag Manager integration
   - Segment integration (via wrapper or middleware)
   - RudderStack integration

The Session Replay functionality works alongside Amplitude Analytics, either directly through Amplitude's SDKs or by connecting with third-party analytics providers. The system captures visual session data and links it to corresponding analytics events through shared session and device identifiers.

## Key Nomenclature and Definitions

- **Session Replay**: The core functionality that records and recreates user interactions with an application.
- **Device ID**: A unique identifier for the user's device that links Session Replay data with analytics events.
- **Session ID**: An identifier for a specific user session that connects replay recordings with analytics session data.
- **Sample Rate**: Configuration parameter (0-100) determining what percentage of sessions to record.
- **Mask Level**: Privacy setting that controls how sensitive data is obscured in recordings:
  - **Conservative**: Highest privacy level, masks most text and images
  - **Light**: Masks only potentially sensitive data
  - **Medium**: Balanced approach between data visibility and privacy
- **Heatmaps**: Visual representations of user engagement including:
  - **Click Maps**: Shows where users click most frequently
  - **Selectors View**: Displays interaction data for specific UI elements
  - **Scrollmaps**: Visualizes how far users scroll on pages
- **Average Fold**: The typical scroll position where content becomes visible to users
- **Ingestion Monitor**: Tool for tracking Session Replay implementation status and debugging issues

## Product Ecosystem Integration

Session Replay integrates into the broader Amplitude product ecosystem by:

1. **Complementing Analytics Data**: Session Replay provides visual context to quantitative analytics data collected by Amplitude Analytics.

2. **Shared Identity System**: Uses the same device ID and session ID system as Amplitude Analytics to connect visual session data with event data.

3. **Organization-level Settings**: Privacy configurations can be managed at the organization level in Amplitude.

4. **Remote Configuration**: Supports remote configuration through Amplitude's configuration system.

5. **Data Residency Options**: Supports EU data residency requirements for organizations that need to keep data in European data centers.

## Implementation Details

### Web Implementation

**Browser SDK Plugin:**
```javascript
import * as amplitude from '@amplitude/analytics-browser';
import { sessionReplayPlugin } from '@amplitude/session-replay-browser';

amplitude.init('API_KEY', {
  plugins: [sessionReplayPlugin()]
});
```

**Standalone SDK:**
```javascript
import { SessionReplay } from '@amplitude/session-replay-browser';

const sessionReplay = new SessionReplay({
  apiKey: 'API_KEY',
  deviceId: 'DEVICE_ID',
  sessionId: 'SESSION_ID'
});
```

### iOS Implementation

**Swift SDK Plugin:**
```swift
import AmplitudeSwift
import AmplitudeSessionReplay

let sessionReplayPlugin = SessionReplayPlugin()
let amplitude = Amplitude(
    configuration: Configuration(
        apiKey: "API_KEY",
        plugins: [sessionReplayPlugin]
    )
)
```

### Android Implementation

**Android SDK Plugin:**
```kotlin
import com.amplitude.android.Amplitude
import com.amplitude.android.plugins.sessionreplay.SessionReplayPlugin

val sessionReplayPlugin = SessionReplayPlugin()
val amplitude = Amplitude(
    Configuration(
        apiKey = "API_KEY",
        context = applicationContext,
        plugins = listOf(sessionReplayPlugin)
    )
)
```

### React Native Implementation

```javascript
import { SessionReplayPlugin } from '@amplitude/session-replay-react-native';

const sessionReplayPlugin = new SessionReplayPlugin();
const amplitude = createInstance();
amplitude.add(sessionReplayPlugin);
```

### Configuration Options

All implementations support these common configuration options:
- `sampleRate`: Controls percentage of sessions to record (0-100)
- `maskLevel`: Sets privacy masking level (CONSERVATIVE, LIGHT, MEDIUM)
- `optOut`: Enables user opt-out functionality
- `euDataResidency`: Enables EU data storage for compliance requirements

### Integration with Third-Party Analytics

For third-party analytics integration, Session Replay provides a `getSessionReplayProperties()` method that returns properties to be included in analytics events:

```javascript
// Example with third-party analytics
const sessionReplayProps = sessionReplay.getSessionReplayProperties();
thirdPartyAnalytics.track('Event Name', {
  ...eventProperties,
  ...sessionReplayProps
});
```

## Platform-Specific Considerations

- **Web**: Supports Shadow DOM, but has limitations with certain CSS styling and requires IndexedDB for storage.
- **iOS**: Supports iOS 13+, WebView, and MapView, but has storage limitations and may impact app performance.
- **Android**: Supports WebView, MapView, and Jetpack Compose, with similar storage and performance considerations.
- **React Native**: Provides AmpMaskView component for masking sensitive UI elements.

All implementations offer methods to start/stop recording during runtime and configure privacy settings to comply with data protection requirements.