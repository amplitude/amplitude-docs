# Amplitude Session Replay

## Product Overview

Amplitude Session Replay is a visual analytics tool that captures and recreates user interactions with web and mobile applications in a video-like format. It allows developers and product teams to visualize exactly how users navigate through applications, interact with elements, and encounter issues. The product works by capturing DOM changes (for web) or view tree changes (for mobile) to create detailed replays of user sessions.

Key features include:
- Video-like session recordings of user interactions
- Heatmaps showing click patterns, scroll depth, and element interactions
- Privacy controls with configurable masking levels for sensitive data
- Cross-platform support (Web, iOS, Android, React Native)
- Integration capabilities with various analytics providers (Segment, Rudderstack)
- Sampling controls to manage data volume
- Implementation monitoring tools

Primary use cases include:
- Debugging user-reported issues by watching actual session recordings
- Understanding user behavior and interaction patterns
- Identifying UI/UX problems and optimization opportunities
- Validating the effectiveness of design changes
- Analyzing user engagement through heatmaps

## Product Relationships and Features

### Core Components

1. **Session Recording**
   - Available across web and mobile platforms
   - Captures DOM/view tree changes to create video-like replays
   - Configurable sampling rates to control data volume
   - Privacy masking options to protect sensitive information

2. **Heatmaps**
   - Click maps showing where users interact most frequently
   - Scrollmaps displaying scroll depth and the "average fold" (how far users typically scroll)
   - Selectors view for analyzing interaction with specific UI elements
   - Filtering capabilities by URL patterns and device types

3. **Ingestion Monitor**
   - Tracks implementation status over time
   - Displays charts for successful requests, throttling errors, quota exceeded errors
   - Helps debug unavailable session replays
   - Monitors overall implementation health

### Platform-Specific SDKs

1. **Web Implementation Options**
   - Browser SDK Plugin: For applications using Amplitude Browser SDK
   - Standalone SDK: For applications using third-party analytics providers
   - Google Tag Manager integration
   - Integration wrappers for Segment and Rudderstack

2. **iOS Implementation Options**
   - iOS Swift SDK Plugin
   - iOS SDK Middleware (for maintenance SDK)
   - iOS Standalone SDK
   - Segment integration for iOS

3. **Android Implementation Options**
   - Android SDK Plugin
   - Android SDK Middleware
   - Android Standalone SDK

4. **React Native Implementation**
   - React Native SDK Plugin

### Integration Capabilities

Session Replay is designed to work with various analytics setups:
- Native integration with Amplitude Analytics
- Third-party analytics providers through standalone SDKs
- Specific integrations for:
  - Segment (via wrapper or middleware)
  - Rudderstack (via wrapper)
  - Google Tag Manager (via Amplitude template)

## Key Nomenclature and Definitions

1. **Session ID**: Unique identifier for a user session that links analytics events to session recordings
2. **Device ID**: Unique identifier for a user's device that helps match session recordings to specific users
3. **Sample Rate**: Percentage of sessions that are recorded (0.0 to 1.0), controlling data volume
4. **Masking Levels**:
   - Conservative: Highest privacy level, masks most elements
   - Medium: Balanced approach to privacy
   - Light: Minimal masking for less sensitive applications
   - Custom: User-defined masking using CSS selectors

5. **CSS Selector Overrides**: Custom rules to mask, unmask, or exclude specific elements from recording
6. **Heatmap Types**:
   - Click maps: Visual representation of where users click
   - Scrollmaps: Visual representation of how far users scroll
   - Selectors: Analysis of interaction with specific UI elements

7. **Average Fold**: The typical scroll depth reached by users on a page
8. **Ingestion Monitor Metrics**:
   - Status 200: Successful requests
   - Status 429: Throttling errors
   - Status 402: Quota exceeded errors
   - Invalid session IDs: Tracking issues with session identification

## Product Ecosystem Integration

Session Replay integrates into the broader Amplitude product ecosystem as an add-on feature available for Growth and Enterprise plans. It extends Amplitude's core analytics capabilities by adding visual context to quantitative data.

The product works by:
1. Capturing user interactions through SDK implementations
2. Storing session data in Amplitude's infrastructure (with EU data residency options available)
3. Making recordings accessible through the Amplitude interface
4. Connecting recordings to analytics events for contextual analysis

Session Replay complements other Amplitude features by providing qualitative insights that help explain the quantitative metrics collected by the core analytics platform. This creates a more comprehensive understanding of user behavior.

## API and Implementation Details

### Web Implementation

**Browser SDK Plugin:**
```javascript
import * as amplitude from '@amplitude/analytics-browser';
import { sessionReplayPlugin } from '@amplitude/session-replay-browser';

amplitude.init('API_KEY', {
  plugins: [sessionReplayPlugin()]
});
```

**Standalone SDK:**
```javascript
import { SessionReplay } from '@amplitude/session-replay-browser-standalone';

const sessionReplay = new SessionReplay({
  apiKey: 'API_KEY',
  deviceId: 'DEVICE_ID',
  sessionId: 'SESSION_ID'
});

// Get properties to add to analytics events
const sessionReplayProperties = sessionReplay.getSessionReplayProperties();
```

### iOS Implementation

**Swift SDK Plugin:**
```swift
import AmplitudeSwift
import AmplitudeSessionReplay

let sessionReplayPlugin = SessionReplayPlugin()
let amplitude = Amplitude(
    configuration: Configuration(
        apiKey: "API_KEY",
        plugins: [sessionReplayPlugin]
    )
)
```

**Standalone SDK:**
```swift
import AmplitudeSessionReplay

let sessionReplay = SessionReplay(
    configuration: SessionReplayConfiguration(
        apiKey: "API_KEY",
        deviceId: "DEVICE_ID",
        sessionId: "SESSION_ID"
    )
)
```

### Android Implementation

**Android SDK Plugin:**
```kotlin
import com.amplitude.android.Amplitude
import com.amplitude.android.plugins.sessionreplay.SessionReplayPlugin

val sessionReplayPlugin = SessionReplayPlugin()
val amplitude = Amplitude(
    Configuration(
        apiKey = "API_KEY",
        context = applicationContext,
        plugins = listOf(sessionReplayPlugin)
    )
)
```

**Standalone SDK:**
```kotlin
import com.amplitude.sessionreplay.SessionReplay

val sessionReplay = SessionReplay(
    SessionReplayConfiguration(
        apiKey = "API_KEY",
        context = applicationContext,
        deviceId = "DEVICE_ID",
        sessionId = "SESSION_ID"
    )
)
```

### React Native Implementation

```javascript
import { SessionReplayPlugin } from '@amplitude/session-replay-react-native';
import { Amplitude } from '@amplitude/react-native';

const sessionReplayPlugin = new SessionReplayPlugin();
const amplitude = Amplitude.getInstance();
amplitude.init('API_KEY', undefined, {
  plugins: [sessionReplayPlugin]
});
```

### Configuration Options

All SDKs support common configuration options:
- `sampleRate`: Controls percentage of sessions recorded (0.0-1.0)
- `maskLevel`: Privacy level (Conservative, Medium, Light)
- `optOut`: Boolean to disable recording for specific users
- `euDataResidency`: Boolean to enable EU data storage

### Privacy Controls

Session Replay offers multiple layers of privacy protection:
1. Preset masking levels (Conservative, Medium, Light)
2. CSS selector overrides for fine-grained control
3. Data attributes for element-specific masking
4. Remote configuration through Amplitude UI
5. User opt-out mechanisms

The UI settings take precedence over SDK configurations to ensure organizational privacy policies are enforced.