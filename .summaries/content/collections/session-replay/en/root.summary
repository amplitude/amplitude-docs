## Amplitude Session Replay

Amplitude Session Replay is a comprehensive user behavior analytics solution that captures and reconstructs user interactions across web, mobile (iOS/Android), and React Native applications. The product provides visual insights through session recordings, heatmaps, and behavioral analysis while maintaining strict privacy controls and compliance with data protection regulations like GDPR.

## Core Features and Capabilities

**Session Recording & Playback**: Captures DOM interactions, user clicks, scrolls, and form inputs through diff-based replay construction that reconstructs user sessions without storing full page snapshots. The system uses view tree capture for mobile platforms and DOM capture for web applications.

**Heatmaps & Visual Analytics**: Provides click maps, selector maps, and scroll maps that visualize user engagement patterns, element ranking, and scroll depth analysis. Heatmaps integrate with Microscope analysis capabilities and support behavioral cohort segmentation.

**Privacy & Compliance Framework**: Implements three-tier masking levels (Conservative, Light, Medium) with CSS selector-based overrides, custom masking controls, and comprehensive consent management integration with Cookie Management Platforms (CMPs).

**Multi-Platform SDK Architecture**: Supports web browsers, iOS/iPadOS, Android, and React Native with plugin-based architecture for existing Amplitude implementations and standalone SDKs for third-party analytics integrations.

## Product Architecture and Integration Patterns

The Session Replay ecosystem follows a modular architecture with distinct integration patterns:

**Plugin Architecture**: For applications already using Amplitude SDKs, Session Replay integrates as plugins (`SessionReplayPlugin`, `AmplitudeSwiftSessionReplayPlugin`, `SessionReplayMiddleware`) that extend existing analytics implementations.

**Standalone SDKs**: Independent implementations for applications using third-party analytics providers (Segment, Rudderstack) requiring manual session/device ID synchronization and explicit event property injection.

**Wrapper Integrations**: Specialized connectors for analytics platforms like Segment (`@amplitude/segment-session-replay-plugin`) and Rudderstack that provide one-line integration with automatic Session Replay ID injection.

**Google Tag Manager Support**: GTM Web Template enables Session Replay deployment through tag management systems with client-side browser implementations.

## Key Technical Components and APIs

**Core SDK Packages**:
- `@amplitude/plugin-session-replay-browser` - Browser SDK Plugin
- `@amplitude/session-replay-browser` - Standalone Browser SDK
- `plugin-session-replay-android` / `middleware-session-replay-android` - Android implementations
- `@amplitude/plugin-session-replay-react-native` - React Native plugin

**Configuration APIs**:
- `sampleRate` - Controls recording frequency (0.0-1.0)
- `privacyConfig` / `maskLevel` - Data masking configuration
- `serverZone` - EU data residency support
- `enableRemoteConfig` - Remote configuration management
- `optOut` - User consent controls

**Session Management Methods**:
- `setSessionId()` / `setDeviceId()` - Manual ID management
- `getSessionReplayProperties()` - Event property injection
- `start()` / `stop()` - Recording control
- `flush()` - Data transmission

**Privacy Controls**:
- `AmpMaskView` component (React Native)
- `.amp-block` CSS class exclusion
- `ugcFilterRules` - URL sanitization with glob patterns
- CSS selector-based masking overrides

## Data Processing and Storage

Session Replay uses IndexedDB for browser storage with configurable `storeType` options. The system implements diff-based processing to minimize data volume, with compression algorithms and idle state optimization through `performanceConfig`. Data retention and transmission are managed through configurable flush intervals and quota management (HTTP 402/429 status handling).

## Monitoring and Debugging

The **Session Replay Ingestion Monitor** provides real-time tracking of ingestion health with HTTP status code monitoring (200, 429, 402) and invalid session ID detection. The system integrates with DSAR API for data subject access requests and User Privacy API for data deletion compliance.

## Enterprise Features

Advanced capabilities include remote configuration precedence, organizational privacy settings management, behavioral cohort analysis, and EU data residency compliance. The platform supports Shadow DOM capture, CSS stylesheet inlining, and experimental WebWorker processing for performance optimization.