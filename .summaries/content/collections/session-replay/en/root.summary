## Amplitude Session Replay

Amplitude Session Replay is a comprehensive user behavior analytics solution that captures and reconstructs user interactions across web, mobile (iOS/Android), and React Native applications. The product provides visual insights through session recordings, heatmaps, and behavioral analytics while maintaining robust privacy controls and compliance features.

## Product Architecture and Integration Ecosystem

Session Replay operates through multiple SDK implementations designed to integrate with existing analytics infrastructures:

**Core SDK Types:**
- **Plugin Architecture**: Integrates with existing Amplitude SDKs (Browser SDK 2, iOS Swift SDK, Android-Kotlin SDK)
- **Middleware Integration**: Works with maintenance/legacy Amplitude SDKs (iOS SDK 8.21.0+, Android SDK 2.40.1+)
- **Standalone SDKs**: Independent implementations for third-party analytics providers
- **Third-Party Wrappers**: Specialized integrations for Segment, Rudderstack, and Google Tag Manager

**Platform Coverage:**
- Web browsers via `@amplitude/plugin-session-replay-browser` and standalone SDK
- iOS/iPadOS through Swift plugins and middleware
- Android via plugins and middleware
- React Native with `@amplitude/plugin-session-replay-react-native`
- Google Tag Manager through GTM Web Template
- Segment integration via Actions, Classic Device-mode, and Cloud-mode destinations

## Key Features and Capabilities

**Session Recording**: Captures DOM interactions, view tree changes (mobile), and user behaviors through diff-based replay construction. Web implementations use DOM capture with shadow DOM support, while mobile platforms employ view tree capture and diffing.

**Heatmaps**: Provides click maps, selector maps, and scroll maps for web-based applications, requiring Browser SDK Plugin 1.7.0+ or Standalone SDK 1.14.0+. Available exclusively for Growth/Enterprise plans with viewport scroll depth and behavioral cohort analysis.

**Privacy and Masking**: Implements three masking levels (Conservative, Light, Medium) with CSS selector-based overrides. Features include PII masking, form field masking, and the `AmpMaskView` component for React Native. Web implementations support `.amp-block` class exclusion and data attribute selectors.

**User-Generated Content Filtering**: The `ugcFilterRules` feature uses glob patterns within `interactionConfig` to sanitize sensitive content in URLs during recording, with selector/replacement pattern matching for anonymizing user IDs and sensitive parameters.

## Key Nomenclature and Technical Concepts

**Session Management**: 
- `sessionId` and `deviceId` synchronization across analytics providers
- `analytics_session_id` cookie for Segment integration
- Manual session management for standalone implementations
- `getSessionReplayProperties()` method for event property injection

**Configuration Parameters**:
- `sampleRate`: Controls recording frequency and performance impact
- `privacyConfig`/`maskLevel`: Defines data masking strictness
- `enableRemoteConfig`: Enables server-side configuration management
- `serverZone`: Supports EU data residency requirements
- `optOut`: Provides user consent controls

**Storage and Performance**:
- IndexedDB storage (`storeType`) for web implementations
- `requestIdleCallback` performance optimization
- Webworker compression for efficient data processing
- `shouldInlineStylesheet` for CSS asset handling

## API Endpoints and Methods

**Core SDK Methods**:
- `amplitude.add(plugin)` / `amplitude.remove(plugin)` for plugin management
- `sessionReplay.init()`, `setSessionId()`, `setDeviceId()` for standalone implementations
- `start()` / `stop()` recording controls
- `flush()` for manual data transmission
- `addEventMiddleware()` / `removeEventMiddleware()` for middleware management

**Integration-Specific APIs**:
- `createSegmentActionsPlugin()` for Segment wrapper
- `AmplitudeSegmentSessionReplayPlugin` for iOS Segment integration
- `SessionReplayMiddleware` for Android middleware
- GTM Web Template configuration through Google Tag Manager interface

## Monitoring and Compliance

**Ingestion Monitor**: Tracks session replay ingestion status with HTTP status code monitoring (200, 429, 402) and invalid session ID detection for implementation debugging.

**Privacy Compliance**: Comprehensive consent management with Cookie Management Platform (CMP) integration, GDPR compliance features, privacy policy disclosure templates, and DSAR API support for data subject access requests.

**Remote Configuration**: Server-side control over sampling rates, masking levels, and feature enablement with precedence rules for SDK vs UI conflict resolution.

The product integrates seamlessly with Amplitude's broader analytics ecosystem while providing flexibility for organizations using third-party analytics providers through standalone SDKs and wrapper implementations.