# Amplitude Web Experiment

## Overview

Amplitude Web Experiment is a visual A/B testing solution that enables non-technical users to create and run experiments on websites without coding knowledge. Users can visually modify website elements, create variants, target specific pages and audiences, and analyze results through Amplitude's analytics platform.

Key features include:
- Visual Editor for creating website variants without code
- Element manipulation (display, visibility, text, background, positioning)
- URL redirects for testing different pages
- Custom code injection (JavaScript, HTML, CSS)
- Page and audience targeting
- Performance optimization with two-layer caching
- Integration with Amplitude Analytics for experiment analysis

Primary use cases include A/B testing website designs, testing UI/UX changes without developer resources, validating user behavior hypotheses, and optimizing conversion rates.

## Product Relationships and Architecture

Web Experiment consists of several interconnected components:

1. **Implementation Layer**: A JavaScript script in the website's `<head>` that loads experiment configurations and applies variants.

2. **Visual Editor**: Interface for creating and modifying variants by selecting and changing website elements.

3. **Targeting System**: Evaluates page targeting (URL patterns) and audience targeting (user properties) to determine experiment eligibility.

4. **Analytics Integration**: Automatically tracks impression events that flow into Amplitude Analytics.

5. **Post-Experiment Workflow**: Process for concluding experiments and implementing winning variants.

The product works alongside other Amplitude products, particularly Amplitude Analytics, which processes impression events for analysis and reporting.

## Key Nomenclature and Definitions

- **Web Experiment**: The overall product for visual A/B testing on websites
- **Visual Editor**: Tool for creating variants by visually modifying website elements
- **Variant**: A modified version of a webpage being tested against the original (control)
- **Element Changes**: Modifications to webpage elements (display, visibility, text, etc.)
- **Anti-flicker Snippet**: Code that prevents flickering during experiment loading
- **Impression Event**: An `[Experiment] Impression` event sent to Amplitude when a user sees an experiment variant
- **Page Targeting**: Rules determining which pages an experiment runs on
- **Audience Targeting**: Rules determining which users are included in an experiment
- **Bucketing**: Process of assigning users to specific variants
- **Flag Key**: Unique identifier for an experiment
- **waitForElement Utility**: Function that waits for DOM elements to appear before applying changes

## Product Ecosystem Integration

Web Experiment integrates with:

1. **Amplitude Analytics**: Impression events are sent to Amplitude Analytics with experiment details for analysis.

2. **Third-party CDPs**: Can integrate with platforms like Segment and Tealium using custom IntegrationPlugins.

3. **Content Management Systems**: Implementation guidance provided for WordPress and Shopify.

4. **Tag Management Systems**: Can be deployed via Google Tag Manager.

5. **Feature Flags**: Winning variants can be implemented as feature flags for permanent implementation.

The product minimizes performance impact through script size optimization (20KB compressed base size plus ~100B per flag), two-layer caching (CDN and browser), and fast local evaluation (<1ms per flag).

## Technical Implementation

### Script Implementation

```html
<!-- Synchronous implementation -->
<script src="https://cdn.amplitude.com/libs/experiment-js-client/1.0.0/experiment.min.js"></script>
<script>
  const experiment = Experiment.initialize({
    apiKey: 'YOUR-API-KEY',
    // Optional configuration
  });
</script>

<!-- Asynchronous implementation with anti-flicker -->
<script>
  // Anti-flicker snippet
  !function(){var e=document.createElement("style");e.textContent=":root{opacity:0;transition:opacity 0.5s;}",document.head.appendChild(e),window.setTimeout(function(){e.textContent=":root{opacity:1;transition:opacity 0.5s;}"},500)}();
  
  // Async loading
  (function(window, document) {
    var script = document.createElement('script');
    script.src = 'https://cdn.amplitude.com/libs/experiment-js-client/1.0.0/experiment.min.js';
    script.onload = function() {
      window.experiment = Experiment.initialize({
        apiKey: 'YOUR-API-KEY',
        // Optional configuration
      });
    };
    document.head.appendChild(script);
  })(window, document);
</script>
```

### Custom Code Actions

```javascript
// Example of custom JavaScript action
function customAction(element) {
  // Modify the element or perform other actions
  element.style.color = 'red';
}

// Example of waitForElement utility
experiment.waitForElement('#my-element', (element) => {
  // Modify the element once it appears in the DOM
  element.innerHTML = 'New content';
});
```

### Targeting Configuration

Page targeting uses URL matching operators:
- `exact`: Exact URL match
- `simple`: Simple pattern matching with * wildcards
- `regex`: Regular expression matching

Audience targeting can use:
- Browser properties (evaluated locally)
- User properties (evaluated remotely)

## Post-Experiment Process

The recommended post-experiment workflow consists of four steps:
1. Analyze results and determine the winning variant
2. Implement the winning variant in production code
3. Document the experiment findings
4. Deactivate the experiment

## Impression Tracking and Billing

Web Experiment automatically tracks impression events (`[Experiment] Impression`) for analysis and billing. The formula for estimating monthly impression volume is:

```
Monthly impressions = Monthly page views × Number of experiments × Percentage of traffic allocated
```

These events include properties like `flag_key`, `variant`, and `experiment_key`, which are transformed during ingestion to set user properties for analysis.