# Amplitude Web Experimentation

Amplitude Web Experimentation is a client-side A/B testing and feature flagging platform that enables teams to run experiments on websites without requiring code deployments. The system provides a Visual Editor for creating experiments through point-and-click interface, supports custom code injection, and offers comprehensive targeting and tracking capabilities.

## Core Features and Use Cases

The platform supports multiple experiment types including A/B tests and multi-armed bandit experiments. Key capabilities include:

- **Visual Editor**: No-code experiment creation through DOM manipulation, allowing element changes (display, visibility, text, background, positioning)
- **Custom Code Actions**: JavaScript, CSS, and HTML injection with utility functions like `waitForElement` and cleanup mechanisms for single-page applications
- **URL Redirects**: Client-side redirects with query parameter retention and session history evaluation
- **Advanced Targeting**: Page-level and audience-level targeting with local and remote evaluation
- **Performance Optimization**: Dynamic script sizing, two-layer caching, and synchronous local evaluation

## Product Relationships and Architecture

### Script Implementation and Integration
The Web Experimentation system operates through a standalone JavaScript SDK that can be implemented synchronously or asynchronously. The script includes anti-flicker snippets to prevent visual artifacts during experiment loading. CDN distribution supports both US (`cdn.amplitude.com`) and EU data centers with Content Security Policy requirements.

### Third-Party Integrations
The platform integrates with Customer Data Platforms through:
- **Segment Integration**: Query parameter-based integration
- **Tealium iQ**: Tag management system integration  
- **Custom IntegrationPlugin Interface**: Extensible integration framework via `experimentIntegration` window variable
- **CMS Platforms**: Native WordPress plugins, Shopify App integration, and Google Tag Manager custom HTML tag support

### Targeting and Evaluation System
The targeting system operates on two levels:
- **Page Targeting**: URL-based evaluation using operators (URL Matches, URL Contains, URL Starts With) that controls where experiments run
- **Audience Targeting**: User segmentation using browser properties (local evaluation) and user properties (remote evaluation with Amplitude ID resolution)

## Key Nomenclature and Definitions

### Experiment Components
- **Flag Key**: Unique identifier for experiments used in tracking events
- **Variants**: Different versions of the experiment including control and treatment groups
- **Variant Actions**: Specific modifications applied by each variant (element changes, redirects, custom code)
- **Bucketing**: Algorithm that assigns users to variants based on Device ID and rollout percentage

### Targeting Concepts
- **Page Scope**: URL patterns that define where experiment variants apply
- **Rollout Percentage**: Traffic allocation control for experiment participation
- **Anti-flicker Overlay**: Mechanism to prevent visual artifacts during experiment evaluation
- **Property Canonicalization**: Standardization of targeting properties for consistent evaluation

### Performance Metrics
- **Dynamic Script Sizing**: Base 79KB + ~1KB per active flag
- **Cache Strategy**: 60-second max-age with stale-while-revalidate for CDN and browser caching
- **Synchronous Evaluation**: <1ms local evaluation time for experiment assignment

## Broader Product Ecosystem Integration

### Amplitude Analytics Integration
Web Experimentation integrates deeply with Amplitude's analytics platform through:
- **Impression Event Tracking**: Automatic transformation from `$impression` to `[Experiment] Impression` events with flag_key and variant properties
- **User Property Setting**: Experiment participation stored as user properties for analysis
- **Behavioral Cohorts**: Integration with Amplitude's user segmentation for audience targeting

### Data Pipeline and Analysis
The system supports comprehensive experiment analysis through:
- **Impression Volume Estimation**: Formula-based calculation (MTU × experiments × page views)
- **Statistical Significance**: Built-in analysis capabilities for experiment results
- **Third-party CDP Events**: Exposure event forwarding to external analytics platforms

## API Endpoints and Technical Implementation

### Script Installation
```html
<!-- Synchronous Implementation -->
<script src="https://cdn.amplitude.com/script/API_KEY/web-experiment.js"></script>

<!-- Asynchronous with Anti-flicker -->
<script>
  // Anti-flicker snippet implementation
</script>
```

### Utility Functions
- `waitForElement()`: Asynchronous DOM element waiting utility
- `utils.remove()`: Cleanup function for single-page application teardown
- Session storage and local storage access for targeting

### Content Security Policy Requirements
```
script-src: cdn.amplitude.com
Cross-Origin-Opener-Policy: unsafe-none
```

## Post-Experiment Workflow

The platform emphasizes migration of winning variants to production code rather than running experiments at 100% traffic allocation. The recommended workflow includes statistical analysis, production implementation, experiment deactivation, and removal of experiment logic to reduce technical debt and improve performance. This approach minimizes clientside overhead and page load execution time while reducing impression volume costs.

The system is designed for Growth and Enterprise plans, with specific features like custom code actions and advanced integrations available at higher tiers.