## Amplitude Experiment Platform

Amplitude Experiment is a comprehensive feature flagging and experimentation platform that enables teams to manage feature rollouts, A/B tests, and controlled experiments through both evaluation and management APIs. The platform supports both remote and local evaluation modes, allowing for flexible deployment strategies across client-side and server-side applications.

## Product Architecture and Feature Relationships

The Amplitude Experiment platform consists of two primary API layers:

**Evaluation API** - Handles real-time feature flag evaluation and variant assignment through:
- `/v1/vardata` endpoint for remote evaluation and variant assignments
- `/v1/flags` endpoint for downloading flag configurations for local evaluation
- Regional server support across multiple data centers

**Management API** - Provides comprehensive CRUD operations for experiment lifecycle management through REST endpoints at `experiment.amplitude.com/api/1/`:
- Experiments (`/experiments`) - A/B tests and multi-arm bandit configurations
- Feature flags (`/flags`) - Feature toggle management with variant configurations
- Deployments (`/deployments`) - Environment and deployment target management
- Mutex groups (`/mutexs`) - Mutual exclusion groups for traffic allocation
- Holdout groups (`/holdouts`) - Control group management for experiment isolation
- Versions (`/versions`) - Historical version tracking and configuration management

## Key Nomenclature and Definitions

**Core Concepts:**
- **Variants** - Different versions of features or experiments with associated payloads and rollout weights
- **Deployments** - Target environments (client/server types) where experiments and flags are deployed
- **Bucketing** - User assignment mechanism using `bucketingKey` (amplitude_id/device_id), `bucketingSalt`, and `bucketingUnit`
- **Evaluation Modes** - `remote` (server-side evaluation) vs `local` (client-side evaluation with downloaded configurations)
- **Target Segments** - User targeting conditions based on properties and cohorts

**Traffic Management:**
- **Rollout Percentage** - Traffic allocation percentage for experiments and flags
- **Rollout Weights** - Distribution weights across variants within allocated traffic
- **Mutex Groups** - Mutual exclusion groups preventing users from being in multiple conflicting experiments
- **Holdout Groups** - Control populations excluded from experiments for baseline measurement

**Experiment States:**
- **Planning** - Experiment configuration phase
- **Running** - Active experiment collecting data
- **Decision-made** - Concluded experiment with decisions (rollout, rollback, continue-running)

## Product Ecosystem Integration

The platform integrates with the broader Amplitude analytics ecosystem through:
- **Event Tracking** - Automatic `[Experiment] Assignment` event generation via `X-Amp-Exp-Track` header
- **User Context** - Integration with user properties, device IDs, and amplitude IDs for targeting
- **Regional Infrastructure** - Multi-region support (api.lab.amplitude.com, api.lab.eu.amplitude.com)
- **SDK Bootstrapping** - `initialFlags` configuration for client-side SDK initialization

## API Specifications and Authentication

**Evaluation API:**
- **Authentication:** `Api-Key` header with deployment keys
- **Primary Endpoints:**
  - `GET /v1/vardata` - Retrieve variant assignments with user context
  - `GET /v1/flags` - Download flag configurations for local evaluation
- **Parameters:** `flag_keys`, `user_id`, `device_id`, `context` with user properties

**Management API:**
- **Authentication:** Bearer token with `management-api-key`
- **Base URL:** `https://experiment.amplitude.com/api/1/`
- **Rate Limiting:** 100 requests per second
- **Pagination:** Cursor-based with `nextCursor` parameter
- **Primary Endpoints:**
  - `GET/POST/PATCH /deployments` - Deployment management
  - `GET/POST/PATCH /experiments` - Experiment lifecycle operations
  - `GET/POST/PATCH /flags` - Feature flag management
  - `GET/POST/PATCH /holdouts` - Holdout group operations
  - `GET/POST/PATCH /mutexs` - Mutex group management
  - `GET /versions` - Version history with ISO 8601 time filtering

The platform supports advanced experimentation features including sticky bucketing, bulk user operations, experiment dependencies, individual user inclusions/exclusions, and comprehensive version control for all configuration changes.