# Amplitude React Native SDK

## Overview

The Amplitude React Native SDK is a client-side analytics solution for tracking user behavior and events in React Native applications. It supports both TypeScript and JavaScript applications and offers comprehensive event tracking, user identification, revenue tracking, and session management capabilities.

The SDK is available in two versions:
- **Latest SDK** (`@amplitude/analytics-react-native`): Recommended version with a modern plugin architecture
- **Maintenance SDK** (`@amplitude/react-native`): Legacy version that is still supported but not actively developed

Key features include:
- Event tracking with custom properties
- User identification and property management
- Revenue tracking
- Session management
- Batch event processing
- EU data residency support
- Plugin architecture for extensibility
- Strongly typed tracking with Ampli Wrapper

## Product Relationships and Architecture

### SDK Versions

1. **Latest React Native SDK** (`@amplitude/analytics-react-native`):
   - Built on a modern plugin architecture
   - More flexible and extensible
   - Supports all core features of the maintenance SDK
   - Recommended for new implementations

2. **Maintenance React Native SDK** (`@amplitude/react-native`):
   - Legacy version with continued support
   - More monolithic architecture
   - Compatible with older React Native versions

3. **Ampli Wrapper**:
   - Code-generated wrapper providing type-safe event tracking
   - Compatible with both SDK versions
   - Generated from Amplitude Data tracking plans

### Integration with Amplitude Ecosystem

The React Native SDK integrates with the broader Amplitude platform:
- Sends data to Amplitude Analytics backend
- Supports EU data residency for regulatory compliance
- Can be extended with plugins for additional functionality
- Works with Amplitude's tracking plan system via Ampli Wrapper

## Key Nomenclature and Definitions

### Event Tracking
- `track()` (latest SDK) / `logEvent()` (maintenance SDK): Methods to record user actions
- **Event properties**: Additional contextual data attached to events

### User Identification
- `identify()`: Method to set or update user properties
- `setUserId()`: Method to identify a user with a unique ID
- `getUserId()`: Method to retrieve the current user ID
- `regenerateDeviceId()`: Method to create a new device ID

### Device Identifiers
- **Device ID**: Unique identifier for the device
- **User ID**: Identifier for the logged-in user
- **ADID**: Advertising identifier
- **IDFV**: Identifier for Vendor (iOS)
- **AppSetId**: Android's app set identifier

### Session Management
- **Session**: A period of user engagement with the app
- `getSessionId()`: Method to retrieve the current session ID
- **Session timeout**: Duration of inactivity before starting a new session

### Plugins (Latest SDK)
- **EnrichmentPlugin**: Adds or modifies event properties before sending
- **DestinationPlugin**: Determines where events are sent
- **ContextPlugin**: Adds contextual information to events

### Ampli Wrapper
- `ampli.load()`: Initializes the Ampli Wrapper
- `ampli.identify()`: Identifies users with the Ampli Wrapper
- `ampli.track()`: Tracks events with type safety
- `ampli.flush()`: Sends events immediately
- `ampli pull`: CLI command to pull tracking plan
- `ampli status`: CLI command to check tracking plan status

## Implementation Details

### Installation

Latest SDK:
```bash
npm install @amplitude/analytics-react-native
```

Maintenance SDK:
```bash
npm install @amplitude/react-native
```

### Initialization

Latest SDK:
```javascript
import { createInstance } from '@amplitude/analytics-react-native';

const amplitude = createInstance();
amplitude.init('API_KEY', 'user@example.com', {
  // Configuration options
});
```

Maintenance SDK:
```javascript
import { Amplitude } from '@amplitude/react-native';

Amplitude.getInstance().init('API_KEY', 'user@example.com', {
  // Configuration options
});
```

### Event Tracking

Latest SDK:
```javascript
amplitude.track('Button Clicked', {
  buttonColor: 'blue',
  buttonText: 'Submit'
});
```

Maintenance SDK:
```javascript
Amplitude.getInstance().logEvent('Button Clicked', {
  buttonColor: 'blue',
  buttonText: 'Submit'
});
```

### User Identification

Latest SDK:
```javascript
import { Identify } from '@amplitude/analytics-react-native';

const identify = new Identify();
identify.set('email', 'user@example.com');
identify.setOnce('initial_signup_date', '2020-01-01');
identify.add('login_count', 1);

amplitude.identify(identify);
```

Maintenance SDK:
```javascript
const identify = new Amplitude.Identify();
identify.set('email', 'user@example.com');
identify.setOnce('initial_signup_date', '2020-01-01');
identify.add('login_count', 1);

Amplitude.getInstance().identify(identify);
```

### Revenue Tracking

Latest SDK:
```javascript
import { Revenue } from '@amplitude/analytics-react-native';

const revenue = new Revenue();
revenue.setProductId('product_1');
revenue.setPrice(10.99);
revenue.setQuantity(2);

amplitude.revenue(revenue);
```

Maintenance SDK:
```javascript
const revenue = new Amplitude.Revenue();
revenue.setProductId('product_1');
revenue.setPrice(10.99);
revenue.setQuantity(2);

Amplitude.getInstance().logRevenueV2(revenue);
```

### Ampli Wrapper Usage

```typescript
import { ampli } from './ampli';

// Initialize
ampli.load({
  client: {
    apiKey: 'API_KEY'
  }
});

// Identify a user
ampli.identify('user-id', {
  userProp: 'value'
});

// Track a typed event
ampli.track('Song Played', {
  songId: 'song-123',
  songName: 'My Song',
  songLength: 180
});
```

## Advanced Features

### Plugins (Latest SDK)

```javascript
import { createInstance } from '@amplitude/analytics-react-native';

// Create a custom enrichment plugin
const enrichmentPlugin = {
  name: 'custom-enrichment',
  type: 'enrichment',
  execute: (event) => {
    event.event_properties = {
      ...event.event_properties,
      app_version: '1.0.0'
    };
    return event;
  }
};

const amplitude = createInstance();
amplitude.add(enrichmentPlugin);
```

### Batch Configuration

```javascript
// Latest SDK
amplitude.init('API_KEY', 'user@example.com', {
  flushQueueSize: 30,
  flushIntervalMillis: 10000
});

// Maintenance SDK
Amplitude.getInstance().init('API_KEY', 'user@example.com', {
  eventUploadThreshold: 30,
  eventUploadPeriodMillis: 10000
});
```

### EU Data Residency

```javascript
// Latest SDK
amplitude.init('API_KEY', 'user@example.com', {
  serverZone: 'EU'
});

// Maintenance SDK
Amplitude.getInstance().init('API_KEY', 'user@example.com', {
  serverZone: 'EU'
});
```

### COPPA Compliance

```javascript
// Latest SDK
amplitude.init('API_KEY', 'user@example.com', {
  trackingOptions: {
    adid: false,
    ipAddress: false
  }
});

// Maintenance SDK
Amplitude.getInstance().enableCoppaControl();
```