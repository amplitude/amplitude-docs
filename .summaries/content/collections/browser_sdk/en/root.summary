## Amplitude Browser SDK Product Ecosystem

The Amplitude Browser SDK is a comprehensive JavaScript/TypeScript analytics platform designed for web applications, providing event tracking, user identification, and marketing attribution capabilities. The ecosystem consists of multiple SDK versions, specialized plugins, and code generation tools that work together to deliver robust analytics functionality.

## Product Architecture and Relationships

### Core SDK Evolution
The product ecosystem centers around three main SDK generations:

**Legacy JavaScript SDK (amplitude-js)** - The original maintenance-mode SDK that established core patterns like `amplitude.getInstance()`, `logEvent()`, and cookie-based storage with AMP_ prefixes. This SDK uses HTTP V1 API endpoints and provides foundational features like revenue tracking, user properties via Identify objects, and basic UTM parameter capture.

**Browser SDK 1.0 (@amplitude/analytics-browser v1)** - The first modern iteration that introduced HTTP V2 API, plugin architecture, and promise-based APIs. It replaced `logEvent()` with unified `track()` methods and eliminated the getInstance() pattern while maintaining backward compatibility for core tracking functionality.

**Browser SDK 2.0 (@amplitude/analytics-browser v2+)** - The current flagship SDK featuring built-in autocapture functionality, consolidated marketing attribution tracking, server-side user agent parsing, and enhanced cookie management. This version provides the most comprehensive feature set including automatic tracking of page views, sessions, form interactions, file downloads, element interactions, and network requests.

### Specialized SDKs and Extensions

**Marketing Analytics Browser SDK (@amplitude/marketing-analytics-browser)** - A maintenance-mode extension of Browser SDK 1.0 that provides enhanced marketing attribution capabilities including first-touch/multi-touch attribution, comprehensive UTM parameter tracking, click ID capture (gclid, fbclid, dclid), and configurable page view tracking for single-page applications.

**Browser Unified SDK (@amplitude/unified)** - A beta integration layer that provides a single entry point for initializing Amplitude Analytics, Experiment, and Session Replay through the `initAll()` method with shared configuration options and bundle size optimization.

### Code Generation Tools

**Ampli Wrappers** - Strongly-typed code generation tools that create JavaScript/TypeScript APIs from Amplitude Data tracking plans:
- Ampli for JavaScript SDK - Works with amplitude-js@^8.21.0 for legacy implementations
- Ampli for Browser SDK 1.0 - Generates CJS modules with @amplitude/analytics-browser dependency
- Ampli for Browser SDK 2.0 - Latest version supporting modern Browser SDK features

All Ampli wrappers use the Ampli CLI with `ampli pull` and `ampli status` commands, providing core methods like `ampli.load()`, `ampli.identify()`, `ampli.track()`, and `ampli.flush()` with JSDoc type checking and EnrichmentPlugin interfaces.

## Key Nomenclature and Definitions

### Core Tracking Concepts
- **Event Tracking**: Primary analytics function using `track()` (modern SDKs) or `logEvent()` (legacy)
- **User Properties**: Managed through Identify interface with methods for setting, adding, and removing user attributes
- **Revenue Tracking**: Specialized tracking using Revenue interface for e-commerce analytics
- **Group Tracking**: Organization-level analytics using `setGroup()` and group properties

### Identity and Session Management
- **Device ID**: Persistent identifier stored in cookies/localStorage for anonymous user tracking
- **User ID**: Custom identifier for authenticated users
- **Session ID**: Temporary identifier for user sessions with configurable timeout
- **Cross-domain Tracking**: Device ID sharing across domains using deviceIdFromURLParam

### Storage and Persistence
- **Cookie Management**: First-party cookies with AMP_ prefix and API key scoping (e.g., AMP_{api_key}_deviceId)
- **Identity Storage**: Configurable storage options including cookies, localStorage, sessionStorage, or none
- **Storage Providers**: Abstraction layer for different persistence mechanisms

### Plugin Architecture
- **Enrichment Plugins**: Modify events before sending (e.g., user agent enrichment, page URL enrichment)
- **Destination Plugins**: Handle event delivery to different endpoints
- **Plugin Interface**: Standardized structure with optional properties for extensibility

### Autocapture and Attribution
- **Default Event Tracking**: Automatic capture of page views, sessions, form interactions, file downloads, and element interactions
- **Marketing Attribution**: UTM parameter tracking, referrer analysis, and campaign attribution
- **Web Attribution**: Consolidated attribution tracking system (V1 vs V2 versions)

## API Endpoints and Configuration

### Core SDK Methods
- **Initialization**: `amplitude.init(apiKey, options)` or `initAll()` for unified SDK
- **Event Tracking**: `amplitude.track(eventType, eventProperties, options)`
- **User Management**: `amplitude.identify(identifyEvent)`, `amplitude.setUserId(userId)`
- **Revenue**: `amplitude.revenue(revenueEvent)`
- **Utility**: `amplitude.flush()`, `amplitude.reset()`

### CLI Commands (Ampli)
- **Code Generation**: `ampli pull` - Downloads and generates tracking code from Data tracking plans
- **Validation**: `ampli status` - Verifies implementation against tracking plan schema

### Configuration Options
- **Transport**: sendBeacon, fetch, or XHR with `transport` option
- **Batching**: `flushQueueSize`, `flushIntervalMillis` for event batching
- **Server Zones**: EU data residency support via `serverZone` configuration
- **Tracking Options**: Granular control over data collection with `trackingOptions`
- **Cookie Configuration**: `cookieOptions.expiration`, `cookieOptions.secure`, `cookieOptions.sameSite`

### Advanced Features
- **Offline Mode**: Event queuing when network unavailable
- **Remote Configuration**: `fetchRemoteConfig()` for dynamic settings
- **Content Security Policy**: CSP-compliant implementations
- **Consent Management**: Deferred initialization patterns for GDPR/CNIL compliance using `deferInitialization` and consent workflows

## Integration Patterns

The SDK ecosystem supports multiple installation methods including script loader, npm/yarn packages, and CDN integration. Migration paths are well-defined between SDK versions, with comprehensive documentation covering breaking changes, API mappings, and configuration updates. The plugin system enables extensibility while maintaining core functionality, and the Ampli code generation tools provide type safety and schema enforcement across the entire analytics implementation.