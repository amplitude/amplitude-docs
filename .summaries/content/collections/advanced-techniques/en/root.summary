# Amplitude Experiment: Advanced Techniques

## Product Overview

Amplitude Experiment is a feature experimentation and flag management platform that enables teams to test new features, conduct A/B tests, and manage feature rollouts. The platform supports both local and remote evaluation modes, allowing for flexible implementation across client and server environments. Key capabilities include experiment creation, variant assignment, traffic allocation, user targeting, and results analysis.

The advanced techniques documentation covers sophisticated use cases and methodologies for optimizing experiment design, implementation, and analysis, including specialized configurations like holdout groups, mutual exclusion groups, and flag prerequisites.

## Product Relationships and Features

### Core Components

1. **Feature Flags and Experiments**
   - **Local Evaluation Flags**: Client-side evaluation using device ID as the bucketing key
   - **Remote Evaluation Flags**: Server-side evaluation with more complex targeting rules
   - **Flag Prerequisites**: Dependencies between flags where one flag's evaluation depends on another's state

2. **User Targeting and Traffic Allocation**
   - **Holdout Groups**: Exclude specific percentages of users from experiments
   - **Mutual Exclusion Groups**: Prevent users from participating in multiple related experiments
   - **Sticky Bucketing**: Ensure consistent variant assignment for users despite targeting changes

3. **Implementation Methods**
   - **Server-Side Rendering**: Combined use of JavaScript Server SDK and Client SDK
   - **Split URL Testing**: No-code A/B testing through URL redirects
   - **Proxy Configurations**: Using AWS CloudFront as a reverse proxy for evaluation servers

4. **Analysis and Metrics**
   - **Advanced Metric Use Cases**: Creating funnel analyses based on experiment metrics
   - **Outlier Detection and Resolution**: Methods to identify and handle data outliers
   - **Multiple Hypothesis Testing**: Statistical corrections for experiments with multiple variants or metrics

5. **Experiment Monitoring**
   - **Cumulative Exposure Analysis**: Interpreting exposure graphs to identify issues
   - **Sample Ratio Mismatch Detection**: Identifying discrepancies between expected and actual variant allocations

### Integration with Amplitude Analytics

Amplitude Experiment integrates closely with Amplitude Analytics, allowing for:
- Importing/exporting experiment chart settings between platforms
- Creating user segments based on experiment variants for funnel analysis
- Using Analytics data to inform experiment targeting and analysis

## Key Nomenclature and Definitions

1. **Evaluation Modes**
   - **Local Evaluation**: Client-side variant assignment using deterministic hashing
   - **Remote Evaluation**: Server-side variant assignment with complex targeting rules

2. **Bucketing Concepts**
   - **Bucketing Key**: Identifier used to assign users to variants (typically device ID or user ID)
   - **Sticky Bucketing**: Mechanism to maintain consistent variant assignment for users
   - **Variant Jumping**: Undesirable situation where users see different variants during an experiment

3. **Experiment Analysis Terms**
   - **Sample Ratio Mismatch (SRM)**: Statistically significant difference between observed and expected variant allocations
   - **Multiple Hypothesis Testing**: Running multiple statistical tests that increase false positive risk
   - **Bonferroni Correction**: Statistical method to adjust for multiple comparisons

4. **Exposure and Assignment**
   - **Exposure Event**: Tracks when a user actually sees a variant
   - **Assignment Event**: Records which variant a user is assigned to
   - **Cumulative Exposures Graph**: Visualization showing exposure accumulation over time

5. **Advanced Configuration Types**
   - **Holdout Groups**: User segments excluded from experiments to measure long-term impacts
   - **Mutual Exclusion Groups**: Configuration to prevent users from participating in multiple related experiments
   - **Flag Prerequisites**: Dependencies between flags where one flag's evaluation depends on another's state

## Product Ecosystem Integration

Amplitude Experiment functions as part of the broader Amplitude product ecosystem:

1. **Amplitude Analytics Integration**
   - Experiment results can be analyzed in Analytics using shared chart settings
   - User properties from experiments can be used for segmentation in Analytics
   - Analytics events can trigger experiment exposure tracking

2. **Development Workflow Integration**
   - Server-side SDKs for various languages (JavaScript, etc.)
   - Client-side SDKs for web and mobile platforms
   - Integration with server-side rendering frameworks

3. **Infrastructure Integration**
   - AWS CloudFront can be configured as a reverse proxy for evaluation servers
   - Support for CMS integration through split URL testing
   - Enterprise features for large-scale deployment (holdout groups, mutual exclusion)

## API Endpoints and Implementation Details

1. **SDK Initialization**
   ```javascript
   // Server SDK initialization
   const experiment = new ExperimentServer({
     apiKey: 'SERVER_API_KEY',
     serverUrl: 'https://api.lab.amplitude.com'
   });

   // Client SDK initialization
   const experimentClient = new ExperimentClient({
     apiKey: 'CLIENT_API_KEY',
     user: { user_id: 'user-id' },
     initialVariants: initialVariants // From server
   });
   ```

2. **Variant Fetching**
   ```javascript
   // Server-side variant fetching
   const variants = await experiment.fetchV2({
     user: { user_id: 'user-id' }
   });

   // Client-side variant access
   const variant = experimentClient.variant('flag-key').value;
   ```

3. **Split URL Testing Implementation**
   ```html
   <script src="https://cdn.amplitude.com/libs/experiment-js-client/1.0.0/experiment.umd.js"></script>
   <script>
     const experiment = new amplitude.Experiment.ExperimentClient({
       apiKey: 'CLIENT_API_KEY',
       configuration: {
         evaluationMode: 'local'
       }
     });
   </script>
   ```

4. **Flag Prerequisites Configuration**
   - Enterprise feature requiring specific configuration in the Amplitude Experiment UI
   - Prevents circular dependencies and ensures proper evaluation order

5. **Holdout Group and Mutual Exclusion Configuration**
   - Enterprise features configured through the Amplitude Experiment UI
   - Require careful traffic allocation planning to ensure sufficient sample sizes

The platform provides comprehensive tools for advanced experimentation scenarios while maintaining integration with analytics for robust analysis of experiment results.