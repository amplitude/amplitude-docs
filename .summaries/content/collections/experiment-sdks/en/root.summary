# Amplitude Experiment: Feature Flag and Experimentation Platform

Amplitude Experiment is a comprehensive feature flag and experimentation platform that enables developers to implement feature flags, run A/B tests, and manage experiments across various platforms and programming languages. The platform supports both client-side and server-side implementations with multiple evaluation methods.

## Key Features and Concepts

- **Feature Flags**: Toggle features on/off for specific users or segments
- **Experiment Variants**: Assign users to different variations of a feature
- **Remote Evaluation**: Server-based evaluation of flags via API calls
- **Local Evaluation**: In-memory evaluation within the application
- **Exposure Tracking**: Automatic or manual tracking of feature flag exposures
- **Cohort Targeting**: Target specific user segments based on properties
- **Account-level Bucketing**: Consistent user experiences across platforms
- **Flag Streaming**: Real-time updates to flag configurations
- **Assignment Tracking**: Track which users are assigned to which variants

## Product Ecosystem and Relationships

Amplitude Experiment consists of multiple SDKs and services that work together:

1. **Client-side SDKs**:
   - JavaScript
   - React Native
   - iOS (Swift)
   - Android
   
2. **Server-side SDKs**:
   - Node.js
   - Python
   - Ruby
   - Go
   - JVM (Java/Kotlin)
   - PHP

3. **Infrastructure Components**:
   - Experiment Evaluation Proxy: For local evaluation within your infrastructure

4. **Integration with Amplitude Analytics**:
   - All SDKs support direct integration with Amplitude Analytics
   - Third-party analytics providers are also supported

## Key Nomenclature and Definitions

- **ExperimentUser**: Object representing a user with properties for targeting
- **Variant**: A specific version of a feature flag (e.g., "on", "off", "control", "treatment")
- **Deployment Key**: Authentication key for SDK initialization (server-side or client-side)
- **Exposure**: When a user encounters a feature flag in the application
- **Bootstrapping**: Pre-loading flag configurations for faster initial evaluation
- **User Provider**: Function that supplies the current user context for evaluation
- **Assignment Event**: Analytics event tracking which variant a user was assigned to
- **Flag Configuration**: The rules and settings that define how a flag behaves
- **Cohort**: A group of users defined by specific properties or behaviors

## Implementation Patterns

All SDKs follow similar implementation patterns:

1. **Installation**: Via package managers (npm, pip, gem, etc.)
2. **Initialization**: Configure the client with deployment keys and options
3. **User Context**: Define user properties for targeting
4. **Variant Fetching/Evaluation**: Get flag values for the current user
5. **Exposure Tracking**: Record when users encounter flags

## Evaluation Methods

### Remote Evaluation
- Makes API calls to Amplitude servers for each evaluation
- Supports all targeting rules without local configuration
- Example (JavaScript):
  ```javascript
  const experiment = new Experiment({ apiKey: 'deployment-key' });
  await experiment.fetch({ user_id: 'user@example.com' });
  const variant = experiment.variant('my-flag');
  ```

### Local Evaluation
- Evaluates flags within the application using downloaded configurations
- Faster performance with no network latency
- Supports most targeting rules including cohorts
- Example (JavaScript):
  ```javascript
  const experiment = new Experiment({ 
    apiKey: 'server-deployment-key',
    serverUrl: 'https://api.lab.amplitude.com'
  });
  await experiment.start();
  const variant = experiment.evaluate('my-flag', { user_id: 'user@example.com' });
  ```

## Experiment Evaluation Proxy

The Evaluation Proxy is a service that:
- Enables local evaluation within your infrastructure
- Supports platforms without native SDKs
- Automatically tracks assignment events with 24-hour deduplication
- Enhances evaluation with large cohort targeting through hourly syncs
- Can be deployed via Docker or Kubernetes
- Uses Redis for persistent storage

API Endpoint: `GET /v1/flags?user=<encoded-user-json>`

## Configuration Options

Common configuration options across SDKs:

- **Server Zone**: `US` or `EU` for data residency compliance
- **Timeout**: Configure network request timeouts
- **Retry Options**: Configure retry behavior for failed requests
- **Polling Interval**: How often to refresh flag configurations
- **Debug Mode**: Enable verbose logging
- **Automatic Exposure Tracking**: Toggle automatic analytics events

## Special Features

- **Flag Streaming**: Real-time updates to flag configurations (supported in server-side SDKs)
- **Amplitude Cookie Integration**: Access user identifiers from Amplitude cookies
- **Server-Side Rendering Support**: Pre-evaluate flags during server rendering
- **Offline Mode**: Function without network connectivity using cached configurations

Each SDK provides language-specific implementations of these core concepts, with slight variations in API design to match language conventions.