# Amplitude Experiment: Feature Flag and Experimentation Platform

## Overview

Amplitude Experiment is a comprehensive platform for feature flagging and experimentation that enables developers to implement feature flags, run A/B tests, and manage experiments across multiple platforms. The solution supports both client-side and server-side implementations with flexible evaluation methods to suit different use cases.

The platform allows teams to:
- Toggle features on/off for specific users or segments
- Assign users to different variations of a feature for A/B testing
- Evaluate flags either remotely (via API) or locally (in-memory)
- Track feature flag exposures automatically or manually
- Target specific user segments based on properties
- Ensure consistent user experiences across platforms with account-level bucketing
- Receive real-time updates to flag configurations through flag streaming

## Product Relationships and Architecture

Amplitude Experiment consists of multiple components that work together:

1. **Client-side SDKs** for user-facing applications:
   - JavaScript
   - React Native
   - iOS (Swift)
   - Android

2. **Server-side SDKs** for backend services:
   - Node.js
   - Python
   - Ruby
   - Go
   - JVM (Java/Kotlin)
   - PHP

3. **Experiment Evaluation Proxy**: A service that enables local evaluation within your infrastructure, particularly useful for platforms without native SDKs.

4. **Integration with Amplitude Analytics**: All SDKs can integrate directly with Amplitude Analytics for tracking experiment results, though third-party analytics providers are also supported.

## Key Nomenclature and Definitions

- **ExperimentUser**: An object representing a user with properties used for targeting and evaluation.
- **Variant**: A specific version of a feature flag (e.g., "on", "off", "control", "treatment").
- **Deployment Key**: Authentication key used for SDK initialization, with separate keys for server-side and client-side implementations.
- **Exposure**: The event when a user encounters a feature flag in the application.
- **Bootstrapping**: Pre-loading flag configurations for faster initial evaluation.
- **User Provider**: A function that supplies the current user context for evaluation.
- **Assignment Event**: Analytics event tracking which variant a user was assigned to.
- **Flag Configuration**: The rules and settings that define how a flag behaves.
- **Cohort**: A group of users defined by specific properties or behaviors for targeting.

## Evaluation Methods

Amplitude Experiment offers two primary evaluation methods:

### Remote Evaluation
- Makes API calls to Amplitude servers for each flag evaluation
- Supports all targeting rules without requiring local configuration
- Typical implementation:
  ```javascript
  const experiment = new Experiment({ apiKey: 'deployment-key' });
  await experiment.fetch({ user_id: 'user@example.com' });
  const variant = experiment.variant('my-flag');
  ```

### Local Evaluation
- Evaluates flags within the application using downloaded configurations
- Provides faster performance with no network latency
- Supports most targeting rules including cohorts
- Typical implementation:
  ```javascript
  const experiment = new Experiment({ 
    apiKey: 'server-deployment-key',
    serverUrl: 'https://api.lab.amplitude.com'
  });
  await experiment.start();
  const variant = experiment.evaluate('my-flag', { user_id: 'user@example.com' });
  ```

## Experiment Evaluation Proxy

The Evaluation Proxy is a specialized service that:
- Enables local evaluation within your infrastructure
- Supports platforms without native SDKs
- Automatically tracks assignment events with 24-hour deduplication
- Enhances evaluation with large cohort targeting through hourly syncs
- Can be deployed via Docker or Kubernetes
- Uses Redis for persistent storage

API Endpoint: `GET /v1/flags?user=<encoded-user-json>`

## Integration with Amplitude Analytics

Amplitude Experiment integrates seamlessly with Amplitude Analytics to:
- Track which users are exposed to which variants
- Analyze experiment results based on key metrics
- Segment users based on experiment participation
- Create cohorts from experiment results for further targeting

## Configuration Options

Common configuration options across SDKs include:
- **Server Zone**: `US` or `EU` for data residency compliance
- **Timeout**: Configure network request timeouts
- **Retry Options**: Configure retry behavior for failed requests
- **Polling Interval**: How often to refresh flag configurations
- **Debug Mode**: Enable verbose logging
- **Automatic Exposure Tracking**: Toggle automatic analytics events

## Special Features

- **Flag Streaming**: Real-time updates to flag configurations (supported in server-side SDKs)
- **Amplitude Cookie Integration**: Access user identifiers from Amplitude cookies
- **Server-Side Rendering Support**: Pre-evaluate flags during server rendering
- **Offline Mode**: Function without network connectivity using cached configurations

Each SDK provides language-specific implementations of these core concepts, with slight variations in API design to match language conventions while maintaining consistent functionality across platforms.