# Ampli: Type-Safe Analytics Instrumentation for Amplitude Data

Ampli is a developer-focused solution that provides type-safe analytics instrumentation for applications, ensuring accurate event tracking according to predefined tracking plans in Amplitude Data. It consists of multiple components that work together to streamline the implementation and validation of analytics tracking code.

## Key Features and Concepts

- **Type-safe analytics tracking**: Eliminates common instrumentation errors through strong typing and code completion
- **Tracking plan integration**: Synchronizes with tracking plans defined in Amplitude Data
- **Instrumentation verification**: Validates that implemented tracking code matches the tracking plan
- **CI/CD integration**: Supports automated validation in continuous integration workflows
- **Source control coordination**: Facilitates collaboration between tracking plan changes and code implementation
- **Progressive migration path**: Enables gradual transition from traditional Amplitude SDK to Ampli

## Product Components and Relationships

### Ampli CLI

The Ampli CLI is a command-line tool that serves as the bridge between Amplitude Data tracking plans and application code. Key functions include:

- **`ampli pull`**: Fetches the latest tracking plan from Amplitude Data and generates type-safe code
- **`ampli status`**: Verifies that implemented tracking matches the tracking plan
- **`ampli checkout`**: Switches between different tracking plan branches

The CLI supports monorepo configurations and can be integrated into CI/CD pipelines for automated verification.

### Ampli Wrapper

The Ampli Wrapper is the generated code library that provides:

- A strongly typed API matching tracking plan definitions
- Type checking and autocompletion for events and properties
- Runtime validation of event data
- Integration with the underlying Amplitude SDK

The wrapper transforms abstract tracking plan definitions into concrete, type-safe code that developers can use directly in their applications.

## Key Nomenclature and Definitions

- **Tracking Plan**: A specification in Amplitude Data that defines events, properties, and their types
- **Ampli Wrapper**: The generated type-safe code library that implements the tracking plan
- **`ampli.json`**: Configuration file that stores settings for the Ampli CLI
- **`ampli.load()`**: Method to initialize the Ampli wrapper with an Amplitude instance
- **`ampli.track()`**: Method to send events through the Ampli wrapper
- **`ampli pull`**: CLI command to generate the Ampli wrapper from a tracking plan
- **`ampli status`**: CLI command to verify tracking implementation against the plan
- **`is-merged` flag**: Indicates if a tracking plan branch has been merged to main
- **`is-latest` flag**: Indicates if the local implementation matches the latest tracking plan

## Product Ecosystem Integration

Ampli fits into the broader Amplitude ecosystem by:

1. Connecting directly to Amplitude Data for tracking plan definitions
2. Wrapping the standard Amplitude SDK for actual event sending
3. Supporting the analytics implementation workflow from specification to validation
4. Enabling collaboration between product managers (who define tracking plans) and developers (who implement them)

Ampli can be used alongside existing Amplitude SDK implementations, allowing for progressive migration.

## API and Command Line Usage

### CLI Commands

```bash
# Generate type-safe wrapper from tracking plan
ampli pull

# Check implementation status against tracking plan
ampli status

# Switch to a different tracking plan branch
ampli checkout <branch-name>
```

### API Usage Examples

```javascript
// Initialize Ampli with Amplitude instance
ampli.load({ client: amplitude });

// Track a strongly-typed event
ampli.productViewed({
  productId: "product-123",
  price: 99.99
});
```

### CI Integration

```yaml
# GitHub Actions example
steps:
  - uses: actions/checkout@v2
  - name: Verify analytics implementation
    run: |
      docker run --rm \
        -e AMPLI_TOKEN=${{ secrets.AMPLI_TOKEN }} \
        -v $(pwd):/app \
        amplitudeinc/ampli status
```

The Ampli CLI can be run in Docker containers (`amplitudeinc/ampli` or `amplitudeinc/ampli-all`) for CI environments, requiring an API token stored in the `AMPLI_TOKEN` environment variable.