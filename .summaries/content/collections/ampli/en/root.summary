# Ampli: Type-Safe Analytics Instrumentation for Amplitude Data

Ampli is a comprehensive analytics instrumentation solution that enables developers to implement tracking plans defined in Amplitude Data with type safety, validation, and seamless integration into development workflows. It consists of two main components: the Ampli CLI and the Ampli Wrapper.

## Key Features and Concepts

- **Type-safe analytics**: Provides strongly typed interfaces that match tracking plan definitions
- **Instrumentation verification**: Validates that code implementation matches tracking plan specifications
- **Source control integration**: Coordinates tracking plan changes across development and analytics teams
- **CI/CD workflows**: Enables automated validation of analytics implementation in continuous integration pipelines
- **Progressive migration**: Supports gradual transition from traditional Amplitude SDK to Ampli

## Product Components and Relationships

### Ampli CLI

The Ampli CLI is a command-line tool that bridges Amplitude Data (where tracking plans are defined) and development environments. It enables developers to:

1. Pull tracking plan definitions from Amplitude Data into local development environments
2. Generate type-safe SDK code based on tracking plan specifications
3. Verify that instrumentation in source code matches tracking plan requirements
4. Manage tracking plan versions across branches and environments

Key commands include:
- `ampli pull`: Downloads tracking plan definitions and generates type-safe code
- `ampli status`: Verifies instrumentation against tracking plan specifications
- `ampli checkout`: Switches between tracking plan branches

### Ampli Wrapper

The Ampli Wrapper is the runtime component that provides:

1. A strongly typed API matching tracking plan definitions
2. Runtime validation of events against tracking plan specifications
3. Integration with the underlying Amplitude SDK for event transmission

The wrapper eliminates error-prone manual JSON object construction by providing type-checked methods that correspond directly to events defined in the tracking plan.

## Key Nomenclature and Definitions

- **Tracking Plan**: A specification defined in Amplitude Data that outlines events, properties, and their expected types
- **ampli.json**: Configuration file that stores tracking plan metadata and Ampli settings
- **Instrumentation**: The implementation of analytics tracking code in an application
- **Type-safe**: Ensuring that events and properties conform to expected types at compile time
- **Branch coordination**: Aligning branches in Amplitude Data with branches in source control

## Integration with Amplitude Ecosystem

Ampli fits into the broader Amplitude ecosystem by:

1. Connecting directly to Amplitude Data for tracking plan definitions
2. Leveraging the underlying Amplitude SDK for event transmission
3. Ensuring data quality by validating events against tracking plan specifications
4. Supporting the entire analytics lifecycle from planning to implementation to verification

Ampli serves as the bridge between analytics planning (done in Amplitude Data) and development implementation, ensuring that the data collected matches what was planned.

## API and Command Line Usage

### Ampli CLI Commands

```bash
# Pull tracking plan and generate code
ampli pull

# Check implementation status
ampli status [--update]

# Switch tracking plan branches
ampli checkout <branch-name>

# CI validation
ampli status --is-merged
ampli status --is-latest
```

### Ampli Wrapper API

```typescript
// Initialize Ampli
ampli.load({
  client: {
    apiKey: "API_KEY",
    // Additional configuration options
  }
});

// Track events with type safety
ampli.trackEventName({
  requiredProperty: "value",
  optionalProperty: 123
});

// Access underlying Amplitude client
const amplitudeClient = ampli.client;
```

### CI Integration

Ampli can be integrated into CI/CD pipelines using Docker containers:

```yaml
# GitHub Actions example
steps:
  - uses: actions/checkout@v2
  - name: Verify analytics implementation
    run: |
      docker run --rm \
        -v $(pwd):/app \
        -w /app \
        -e AMPLI_TOKEN=${{ secrets.AMPLI_TOKEN }} \
        amplitudeinc/ampli status --is-merged
```