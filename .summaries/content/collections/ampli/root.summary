# Ampli: Type-Safe Analytics Instrumentation for Amplitude

## Overview

Ampli is a developer-focused solution that provides type-safe analytics instrumentation for applications, ensuring accurate event tracking according to predefined tracking plans in Amplitude Data. It bridges the gap between tracking plan specifications and implementation code, reducing errors and improving developer productivity through strong typing, code completion, and validation.

## Key Features

- **Type-safe analytics tracking**: Eliminates common instrumentation errors through strong typing and code completion
- **Tracking plan integration**: Synchronizes with tracking plans defined in Amplitude Data
- **Instrumentation verification**: Validates that implemented tracking code matches the tracking plan
- **CI/CD integration**: Supports automated validation in continuous integration workflows
- **Source control coordination**: Facilitates collaboration between tracking plan changes and code implementation
- **Progressive migration path**: Enables gradual transition from traditional Amplitude SDK to Ampli

## Product Components and Relationships

Ampli consists of two main components that work together:

1. **Ampli CLI**: Command-line tool that fetches tracking plans from Amplitude Data and generates type-safe code
2. **Ampli Wrapper**: Generated code library that provides a strongly typed API matching tracking plan definitions

The workflow typically involves:
- Product managers define tracking plans in Amplitude Data
- Developers use Ampli CLI to pull these plans and generate type-safe code
- Developers implement analytics using the generated Ampli Wrapper
- Ampli CLI validates that implementation matches the tracking plan
- The Ampli Wrapper sends events to Amplitude through the standard SDK

## Key Nomenclature and Definitions

- **Tracking Plan**: A specification in Amplitude Data that defines events, properties, and their types
- **Ampli Wrapper**: The generated type-safe code library that implements the tracking plan
- **`ampli.json`**: Configuration file that stores settings for the Ampli CLI
- **`ampli.load()`**: Method to initialize the Ampli wrapper with an Amplitude instance
- **`ampli.track()`**: Method to send events through the Ampli wrapper
- **`ampli pull`**: CLI command to generate the Ampli wrapper from a tracking plan
- **`ampli status`**: CLI command to verify tracking implementation against the plan
- **`is-merged` flag**: Indicates if a tracking plan branch has been merged to main
- **`is-latest` flag**: Indicates if the local implementation matches the latest tracking plan

## Product Ecosystem Integration

Ampli integrates with the broader Amplitude ecosystem by:

1. **Amplitude Data Integration**: Directly connects to Amplitude Data to fetch tracking plan definitions
2. **SDK Wrapping**: Encapsulates the standard Amplitude SDK for event transmission
3. **Workflow Support**: Bridges the gap between tracking plan specification and implementation
4. **Collaborative Development**: Enables collaboration between product managers and developers

Ampli can coexist with traditional Amplitude SDK implementations, allowing teams to gradually migrate to the type-safe approach.

## API and Command Line Usage

### CLI Commands

```bash
# Generate type-safe wrapper from tracking plan
ampli pull

# Check implementation status against tracking plan
ampli status

# Switch to a different tracking plan branch
ampli checkout <branch-name>
```

### API Usage Examples

```javascript
// Initialize Ampli with Amplitude instance
ampli.load({ client: amplitude });

// Track a strongly-typed event
ampli.productViewed({
  productId: "product-123",
  price: 99.99
});
```

### CI Integration

The Ampli CLI can be run in Docker containers for CI environments:

```yaml
# GitHub Actions example
steps:
  - uses: actions/checkout@v2
  - name: Verify analytics implementation
    run: |
      docker run --rm \
        -e AMPLI_TOKEN=${{ secrets.AMPLI_TOKEN }} \
        -v $(pwd):/app \
        amplitudeinc/ampli status
```

Two Docker images are available:
- `amplitudeinc/ampli`: Basic image with Ampli CLI
- `amplitudeinc/ampli-all`: Comprehensive image with additional dependencies

Authentication requires an API token stored in the `AMPLI_TOKEN` environment variable.